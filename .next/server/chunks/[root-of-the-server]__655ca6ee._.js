module.exports=[70406,(e,r,t)=>{r.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},18622,(e,r,t)=>{r.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},93695,(e,r,t)=>{r.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},982,(e,r,t)=>{r.exports={MAX_REQUEST_SIZE:{DEFAULT:1048576,LARGE:0xa00000},REQUEST_TIMEOUT:3e4,RATE_LIMIT:{WINDOW:6e4,MAX_REQUESTS:10},CACHE_TTL:{ACCOUNTS:1,CASES:1,CONTACTS:24,TRANSCRIPTIONS:24,LINKEDIN_PROFILES:24,CALENDAR_EVENTS:15},API_LIMITS:{CASES_PER_ACCOUNT:25,CONTACTS_PER_ACCOUNT:100,ACCOUNTS_PER_USER:1e3}}},81944,(e,r,t)=>{let{MAX_REQUEST_SIZE:n,REQUEST_TIMEOUT:s}=e.r(982);function o(e,r=["GET","POST","OPTIONS"]){e.setHeader("Access-Control-Allow-Origin","*"),e.setHeader("Access-Control-Allow-Methods",r.join(", ")),e.setHeader("Access-Control-Allow-Headers","Content-Type, Authorization")}function a(e,r=!1){return r?{error:"An error occurred",message:"Please try again later or contact support if the problem persists."}:{error:e.message||"An error occurred",message:e.message,stack:e.stack}}function i(e,r,t=500,n=!1){o(e);let s=a(r,n);return e.status(t).json(s)}function l(){return!0}function u(e,r){let t=new Date().toISOString();return`[${t}] [${e.toUpperCase()}] ${r}`}let c=new Map,{RATE_LIMIT:d}=e.r(982);setInterval(()=>{let e=Date.now();for(let[r,t]of c.entries())e>t.resetTime&&c.delete(r)},d.WINDOW),r.exports={setCORSHeaders:o,handlePreflight:function(e,r){return"OPTIONS"===e.method&&(o(r),r.status(200).end())},validateRequestSize:function(e,r=n.DEFAULT){let t=e.headers["content-length"];return t&&parseInt(t)>r?{valid:!1,error:{status:413,message:"Request too large"}}:{valid:!0}},sanitizeError:a,sendErrorResponse:i,sendSuccessResponse:function(e,r,t=200){return o(e),e.status(t).json(r)},getClientIP:function(e){return e.headers["x-forwarded-for"]?.split(",")[0]||e.headers["x-real-ip"]||e.connection?.remoteAddress||"unknown"},validateSupabase:function(e,r){return!!e||(i(r,Error("Database not configured"),503,!0),!1)},checkRateLimit:function(e,r,t){let n=Date.now();if(!c.has(e))return c.set(e,{count:1,resetTime:n+r}),!0;let s=c.get(e);return n>s.resetTime?(s.count=1,s.resetTime=n+r,!0):!(s.count>=t)&&(s.count++,!0)},isProduction:l,log:function(e,r=null){},logError:function(e,r=null){r?console.error(u("error",e),r):console.error(u("error",e))},logWarn:function(e,r=null){},logDebug:function(e,r=null){}}},3030,e=>{"use strict";var r=e.i(89171);let t=e.r(81944),{MAX_REQUEST_SIZE:n,REQUEST_TIMEOUT:s,RATE_LIMIT:o}=e.r(982);function a(e,r=["GET","POST","OPTIONS"]){return e.headers.set("Access-Control-Allow-Origin","*"),e.headers.set("Access-Control-Allow-Methods",r.join(", ")),e.headers.set("Access-Control-Allow-Headers","Content-Type, Authorization"),e}async function i(e){return"OPTIONS"===e.method?a(new r.NextResponse(null,{status:200})):null}function l(e,r=n.DEFAULT){let t=e.headers.get("content-length");return t&&parseInt(t)>r?{valid:!1,error:{status:413,message:"Request too large"}}:{valid:!0}}function u(e,n=500){let s=t.isProduction(),o={error:s?"An error occurred":e?.message||"An error occurred",message:s?"Please try again later or contact support if the problem persists.":e?.message||"An error occurred"};return!s&&e?.stack&&(o.stack=e.stack),a(r.NextResponse.json(o,{status:n}))}function c(e,t=200){return a(r.NextResponse.json(e,{status:t}))}function d(e){let r=e.headers.get("x-forwarded-for");return r?r.split(",")[0].trim():e.headers.get("x-real-ip")||"unknown"}function p(e){return e?{valid:!0}:{valid:!1,error:{status:503,message:"Database not configured"}}}function f(e,r,n){return t.checkRateLimit(e,r,n)}let h=t.log,E=t.logError,g=t.logWarn;t.logDebug;let R=t.isProduction;e.s(["checkRateLimit",()=>f,"getClientIP",()=>d,"handlePreflight",()=>i,"isProduction",0,R,"log",0,h,"logError",0,E,"logWarn",0,g,"sendErrorResponse",()=>u,"sendSuccessResponse",()=>c,"validateRequestSize",()=>l,"validateSupabase",()=>p])},6775,e=>{"use strict";var r=e.i(47909),t=e.i(74017),n=e.i(96250),s=e.i(59756),o=e.i(61916),a=e.i(14444),i=e.i(37092),l=e.i(69741),u=e.i(16795),c=e.i(87718),d=e.i(95169),p=e.i(47587),f=e.i(66012),h=e.i(70101),E=e.i(26937),g=e.i(10372),R=e.i(93695);e.i(52474);var m=e.i(220);e.i(89171);var A=e.i(69122),v=e.i(3030);function x(e,r){console.error(`[ERROR] ${e}`,r)}async function w(){let e=new Response(null,{status:200});return e.headers.set("Access-Control-Allow-Origin","*"),e.headers.set("Access-Control-Allow-Methods","POST, DELETE, OPTIONS"),e.headers.set("Access-Control-Allow-Headers","Content-Type, Authorization"),e}async function C(e){try{let{userId:r,accountId:t}=await e.json();if(!r)return(0,v.sendErrorResponse)(Error("Missing required field: userId"),400);if(!t)return(0,v.sendErrorResponse)(Error("Missing required field: accountId"),400);let n=(0,A.getSupabaseClient)(),s=(0,A.validateSupabase)(n);if(!s.valid)return(0,v.sendErrorResponse)(Error(s.error.message),s.error.status);let{data:o,error:a}=await n.from("users").select("id").eq("id",r).single();if(a||!o)return(0,v.sendErrorResponse)(Error("User not found"),404);let{data:i,error:l}=await n.from("accounts").select("id, salesforce_id").eq("salesforce_id",t).single();if(l||!i)return(0,v.sendErrorResponse)(Error(`Account with Salesforce ID "${t}" not found in cache. Please search for the account first to cache it.`),404);let{data:u,error:c}=await n.from("user_accounts").upsert({user_id:r,account_id:i.id},{onConflict:"user_id,account_id",ignoreDuplicates:!1}).select().single();if(c)return x("Error creating user-account relationship:",c),(0,v.sendErrorResponse)(Error("Failed to add account relationship"),500);return(0,v.sendSuccessResponse)({message:"Account added successfully",relationship:u})}catch(e){return x("Error in POST /api/users/accounts:",e),(0,v.sendErrorResponse)(e,500)}}async function T(e){try{let{userId:r,accountId:t,accountIds:n,clearAll:s}=await e.json();if(!r)return(0,v.sendErrorResponse)(Error("Missing required field: userId"),400);let o=(0,A.getSupabaseClient)(),a=(0,A.validateSupabase)(o);if(!a.valid)return(0,v.sendErrorResponse)(Error(a.error.message),a.error.status);let{data:i,error:l}=await o.from("users").select("id").eq("id",r).single();if(l||!i)return(0,v.sendErrorResponse)(Error("User not found"),404);if(s){let{count:e,error:t}=await o.from("user_accounts").select("*",{count:"exact",head:!0}).eq("user_id",r);t&&x("Error counting user-account relationships:",t);let{error:n}=await o.from("user_accounts").delete().eq("user_id",r);if(n)return x("Error deleting user-account relationships:",n),(0,v.sendErrorResponse)(Error("Failed to clear account relationships"),500);return(0,v.sendSuccessResponse)({message:"Successfully cleared all account relationships",clearedCount:e||0})}if(n&&Array.isArray(n)&&n.length>0){let{data:e,error:t}=await o.from("accounts").select("id, salesforce_id").in("salesforce_id",n);if(t)return x("Error fetching accounts:",t),(0,v.sendErrorResponse)(Error("Failed to fetch accounts"),500);if(!e||0===e.length)return(0,v.sendErrorResponse)(Error("No matching accounts found in cache"),404);let s=e.map(e=>e.id),{error:a}=await o.from("user_accounts").delete().eq("user_id",r).in("account_id",s);if(a)return x("Error deleting user-account relationships:",a),(0,v.sendErrorResponse)(Error("Failed to remove account relationships"),500);return(0,v.sendSuccessResponse)({message:`Successfully removed ${e.length} account${e.length>1?"s":""}`,removedCount:e.length})}{if(!t)return(0,v.sendErrorResponse)(Error("Missing required field: accountId, accountIds, or clearAll"),400);let{data:e,error:n}=await o.from("accounts").select("id, salesforce_id").eq("salesforce_id",t).single();if(n||!e)return(0,v.sendErrorResponse)(Error(`Account with Salesforce ID "${t}" not found in cache. Please search for the account first to cache it.`),404);let{error:s}=await o.from("user_accounts").delete().eq("user_id",r).eq("account_id",e.id);if(s)return x("Error deleting user-account relationship:",s),(0,v.sendErrorResponse)(Error("Failed to remove account relationship"),500);return(0,v.sendSuccessResponse)({message:"Account removed successfully"})}}catch(e){return x("Error in DELETE /api/users/accounts:",e),(0,v.sendErrorResponse)(e,500)}}e.s(["DELETE",()=>T,"OPTIONS",()=>w,"POST",()=>C],31819);var S=e.i(31819);let _=new r.AppRouteRouteModule({definition:{kind:t.RouteKind.APP_ROUTE,page:"/api/users/accounts/route",pathname:"/api/users/accounts",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/users/accounts/route.js",nextConfigOutput:"",userland:S}),{workAsyncStorage:O,workUnitAsyncStorage:y,serverHooks:P}=_;function I(){return(0,n.patchFetch)({workAsyncStorage:O,workUnitAsyncStorage:y})}async function N(e,r,n){_.isDev&&(0,s.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let A="/api/users/accounts/route";A=A.replace(/\/index$/,"")||"/";let v=await _.prepare(e,r,{srcPage:A,multiZoneDraftMode:!1});if(!v)return r.statusCode=400,r.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:x,params:w,nextConfig:C,parsedUrl:T,isDraftMode:S,prerenderManifest:O,routerServerContext:y,isOnDemandRevalidate:P,revalidateOnlyGenerated:I,resolvedPathname:N,clientReferenceManifest:b,serverActionsManifest:q}=v,D=(0,l.normalizeAppPath)(A),k=!!(O.dynamicRoutes[D]||O.routes[N]),U=async()=>((null==y?void 0:y.render404)?await y.render404(e,r,T,!1):r.end("This page could not be found"),null);if(k&&!S){let e=!!O.routes[N],r=O.dynamicRoutes[D];if(r&&!1===r.fallback&&!e){if(C.experimental.adapterPath)return await U();throw new R.NoFallbackError}}let M=null;!k||_.isDev||S||(M="/index"===(M=N)?"/":M);let j=!0===_.isDev||!k,H=k&&!j;q&&b&&(0,a.setReferenceManifestsSingleton)({page:A,clientReferenceManifest:b,serverActionsManifest:q,serverModuleMap:(0,i.createServerModuleMap)({serverActionsManifest:q})});let L=e.method||"GET",F=(0,o.getTracer)(),$=F.getActiveScopeSpan(),K={params:w,prerenderManifest:O,renderOpts:{experimental:{authInterrupts:!!C.experimental.authInterrupts},cacheComponents:!!C.cacheComponents,supportsDynamicResponse:j,incrementalCache:(0,s.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:C.cacheLife,waitUntil:n.waitUntil,onClose:e=>{r.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(r,t,n)=>_.onRequestError(e,r,n,y)},sharedContext:{buildId:x}},W=new u.NodeNextRequest(e),z=new u.NodeNextResponse(r),G=c.NextRequestAdapter.fromNodeNextRequest(W,(0,c.signalFromNodeResponse)(r));try{let a=async e=>_.handle(G,K).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":r.statusCode,"next.rsc":!1});let t=F.getRootSpanAttributes();if(!t)return;if(t.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${t.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=t.get("next.route");if(n){let r=`${L} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":r}),e.updateName(r)}else e.updateName(`${L} ${A}`)}),i=!!(0,s.getRequestMeta)(e,"minimalMode"),l=async s=>{var o,l;let u=async({previousCacheEntry:t})=>{try{if(!i&&P&&I&&!t)return r.statusCode=404,r.setHeader("x-nextjs-cache","REVALIDATED"),r.end("This page could not be found"),null;let o=await a(s);e.fetchMetrics=K.renderOpts.fetchMetrics;let l=K.renderOpts.pendingWaitUntil;l&&n.waitUntil&&(n.waitUntil(l),l=void 0);let u=K.renderOpts.collectedTags;if(!k)return await (0,f.sendResponse)(W,z,o,K.renderOpts.pendingWaitUntil),null;{let e=await o.blob(),r=(0,h.toNodeOutgoingHttpHeaders)(o.headers);u&&(r[g.NEXT_CACHE_TAGS_HEADER]=u),!r["content-type"]&&e.type&&(r["content-type"]=e.type);let t=void 0!==K.renderOpts.collectedRevalidate&&!(K.renderOpts.collectedRevalidate>=g.INFINITE_CACHE)&&K.renderOpts.collectedRevalidate,n=void 0===K.renderOpts.collectedExpire||K.renderOpts.collectedExpire>=g.INFINITE_CACHE?void 0:K.renderOpts.collectedExpire;return{value:{kind:m.CachedRouteKind.APP_ROUTE,status:o.status,body:Buffer.from(await e.arrayBuffer()),headers:r},cacheControl:{revalidate:t,expire:n}}}}catch(r){throw(null==t?void 0:t.isStale)&&await _.onRequestError(e,r,{routerKind:"App Router",routePath:A,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:P})},y),r}},c=await _.handleResponse({req:e,nextConfig:C,cacheKey:M,routeKind:t.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:O,isRoutePPREnabled:!1,isOnDemandRevalidate:P,revalidateOnlyGenerated:I,responseGenerator:u,waitUntil:n.waitUntil,isMinimalMode:i});if(!k)return null;if((null==c||null==(o=c.value)?void 0:o.kind)!==m.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(l=c.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});i||r.setHeader("x-nextjs-cache",P?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),S&&r.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let d=(0,h.fromNodeOutgoingHttpHeaders)(c.value.headers);return i&&k||d.delete(g.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||r.getHeader("Cache-Control")||d.get("Cache-Control")||d.set("Cache-Control",(0,E.getCacheControlHeader)(c.cacheControl)),await (0,f.sendResponse)(W,z,new Response(c.value.body,{headers:d,status:c.value.status||200})),null};$?await l($):await F.withPropagatedContext(e.headers,()=>F.trace(d.BaseServerSpan.handleRequest,{spanName:`${L} ${A}`,kind:o.SpanKind.SERVER,attributes:{"http.method":L,"http.target":e.url}},l))}catch(r){if(r instanceof R.NoFallbackError||await _.onRequestError(e,r,{routerKind:"App Router",routePath:D,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:P})}),k)throw r;return await (0,f.sendResponse)(W,z,new Response(null,{status:500})),null}}e.s(["handler",()=>N,"patchFetch",()=>I,"routeModule",()=>_,"serverHooks",()=>P,"workAsyncStorage",()=>O,"workUnitAsyncStorage",()=>y],6775)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__655ca6ee._.js.map