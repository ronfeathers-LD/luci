{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/ron.feathers/GitHub/LUCI/src/lib/supabase-server.js"],"sourcesContent":["/**\n * Server-side Supabase Client for Next.js\n * Uses the same logic as lib/supabase-client.js but as ES module\n */\n\nexport function getSupabaseClient() {\n  try {\n    const { createClient } = require('@supabase/supabase-js');\n    const supabaseUrl = process.env.SUPABASE_URL;\n    const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n    \n    if (!supabaseUrl || !supabaseServiceKey) {\n      const missing = [];\n      if (!supabaseUrl) missing.push('SUPABASE_URL');\n      if (!supabaseServiceKey) missing.push('SUPABASE_SERVICE_ROLE_KEY');\n      console.error(`[Supabase] Missing environment variables: ${missing.join(', ')}`);\n      return null;\n    }\n    \n    return createClient(supabaseUrl, supabaseServiceKey, {\n      auth: {\n        autoRefreshToken: false,\n        persistSession: false\n      }\n    });\n  } catch (error) {\n    console.error('[Supabase] Error creating client:', error.message);\n    if (error.stack) {\n      console.error('[Supabase] Stack:', error.stack);\n    }\n    return null;\n  }\n}\n\nexport function validateSupabase(supabase) {\n  if (!supabase) {\n    return {\n      valid: false,\n      error: { status: 503, message: 'Database not configured' }\n    };\n  }\n  return { valid: true };\n}\n\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;AAEM,SAAS;IACd,IAAI;QACF,MAAM,EAAE,YAAY,EAAE;QACtB,MAAM,cAAc,QAAQ,GAAG,CAAC,YAAY;QAC5C,MAAM,qBAAqB,QAAQ,GAAG,CAAC,yBAAyB;QAEhE,IAAI,CAAC,eAAe,CAAC,oBAAoB;YACvC,MAAM,UAAU,EAAE;YAClB,IAAI,CAAC,aAAa,QAAQ,IAAI,CAAC;YAC/B,IAAI,CAAC,oBAAoB,QAAQ,IAAI,CAAC;YACtC,QAAQ,KAAK,CAAC,CAAC,0CAA0C,EAAE,QAAQ,IAAI,CAAC,OAAO;YAC/E,OAAO;QACT;QAEA,OAAO,aAAa,aAAa,oBAAoB;YACnD,MAAM;gBACJ,kBAAkB;gBAClB,gBAAgB;YAClB;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qCAAqC,MAAM,OAAO;QAChE,IAAI,MAAM,KAAK,EAAE;YACf,QAAQ,KAAK,CAAC,qBAAqB,MAAM,KAAK;QAChD;QACA,OAAO;IACT;AACF;AAEO,SAAS,iBAAiB,QAAQ;IACvC,IAAI,CAAC,UAAU;QACb,OAAO;YACL,OAAO;YACP,OAAO;gBAAE,QAAQ;gBAAK,SAAS;YAA0B;QAC3D;IACF;IACA,OAAO;QAAE,OAAO;IAAK;AACvB"}},
    {"offset": {"line": 98, "column": 0}, "map": {"version":3,"sources":["file:///Users/ron.feathers/GitHub/LUCI/lib/constants.js"],"sourcesContent":["/**\n * Shared Constants\n * \n * Centralized constants used across the application\n */\n\n// Request limits\nconst MAX_REQUEST_SIZE = {\n  DEFAULT: 1024 * 1024, // 1MB\n  LARGE: 10 * 1024 * 1024, // 10MB (for sentiment analysis)\n};\n\n// Timeouts\nconst REQUEST_TIMEOUT = 30000; // 30 seconds\n\n// Rate limiting\nconst RATE_LIMIT = {\n  WINDOW: 60 * 1000, // 1 minute\n  MAX_REQUESTS: 10, // 10 requests per minute per IP\n};\n\n// Cache TTL (in hours, except CALENDAR_EVENTS which is in minutes)\nconst CACHE_TTL = {\n  ACCOUNTS: 1, // 1 hour\n  CASES: 1, // 1 hour\n  CONTACTS: 24, // 24 hours\n  TRANSCRIPTIONS: 24, // 24 hours\n  LINKEDIN_PROFILES: 24, // 24 hours\n  CALENDAR_EVENTS: 15, // 15 minutes (calendar events change frequently)\n};\n\n// API Limits\nconst API_LIMITS = {\n  CASES_PER_ACCOUNT: 25,\n  CONTACTS_PER_ACCOUNT: 100,\n  ACCOUNTS_PER_USER: 1000,\n};\n\nmodule.exports = {\n  MAX_REQUEST_SIZE,\n  REQUEST_TIMEOUT,\n  RATE_LIMIT,\n  CACHE_TTL,\n  API_LIMITS,\n};\n\n"],"names":[],"mappings":"AAAA;;;;CAIC,GAED,iBAAiB;AACjB,MAAM,mBAAmB;IACvB,SAAS,OAAO;IAChB,OAAO,KAAK,OAAO;AACrB;AAEA,WAAW;AACX,MAAM,kBAAkB,OAAO,aAAa;AAE5C,gBAAgB;AAChB,MAAM,aAAa;IACjB,QAAQ,KAAK;IACb,cAAc;AAChB;AAEA,mEAAmE;AACnE,MAAM,YAAY;IAChB,UAAU;IACV,OAAO;IACP,UAAU;IACV,gBAAgB;IAChB,mBAAmB;IACnB,iBAAiB;AACnB;AAEA,aAAa;AACb,MAAM,aAAa;IACjB,mBAAmB;IACnB,sBAAsB;IACtB,mBAAmB;AACrB;AAEA,OAAO,OAAO,GAAG;IACf;IACA;IACA;IACA;IACA;AACF"}},
    {"offset": {"line": 139, "column": 0}, "map": {"version":3,"sources":["file:///Users/ron.feathers/GitHub/LUCI/lib/api-helpers.js"],"sourcesContent":["/**\n * Shared API Helper Functions\n * \n * Common utilities for Vercel serverless functions\n */\n\nconst { MAX_REQUEST_SIZE, REQUEST_TIMEOUT } = require('./constants');\n\n/**\n * Set standard CORS headers\n */\nfunction setCORSHeaders(res, methods = ['GET', 'POST', 'OPTIONS']) {\n  res.setHeader('Access-Control-Allow-Origin', '*');\n  res.setHeader('Access-Control-Allow-Methods', methods.join(', '));\n  res.setHeader('Access-Control-Allow-Headers', 'Content-Type, Authorization');\n}\n\n/**\n * Handle preflight OPTIONS requests\n */\nfunction handlePreflight(req, res) {\n  if (req.method === 'OPTIONS') {\n    setCORSHeaders(res);\n    return res.status(200).end();\n  }\n  return false;\n}\n\n/**\n * Validate request size\n */\nfunction validateRequestSize(req, maxSize = MAX_REQUEST_SIZE.DEFAULT) {\n  const contentLength = req.headers['content-length'];\n  if (contentLength && parseInt(contentLength) > maxSize) {\n    return {\n      valid: false,\n      error: {\n        status: 413,\n        message: 'Request too large',\n      },\n    };\n  }\n  return { valid: true };\n}\n\n/**\n * Sanitize error message for production\n */\nfunction sanitizeError(error, isProduction = false) {\n  if (isProduction) {\n    // In production, don't expose internal error details\n    return {\n      error: 'An error occurred',\n      message: 'Please try again later or contact support if the problem persists.',\n    };\n  }\n  \n  // In development, return full error details\n  return {\n    error: error.message || 'An error occurred',\n    message: error.message,\n    stack: error.stack,\n  };\n}\n\n/**\n * Standard error response\n */\nfunction sendErrorResponse(res, error, statusCode = 500, isProduction = false) {\n  setCORSHeaders(res);\n  const sanitized = sanitizeError(error, isProduction);\n  return res.status(statusCode).json(sanitized);\n}\n\n/**\n * Standard success response\n */\nfunction sendSuccessResponse(res, data, statusCode = 200) {\n  setCORSHeaders(res);\n  return res.status(statusCode).json(data);\n}\n\n/**\n * Get client IP address from request\n */\nfunction getClientIP(req) {\n  return req.headers['x-forwarded-for']?.split(',')[0] || \n         req.headers['x-real-ip'] || \n         req.connection?.remoteAddress || \n         'unknown';\n}\n\n/**\n * Validate Supabase client and return error response if invalid\n * \n * @param {Object|null} supabase - Supabase client instance\n * @param {Object} res - Express response object\n * @returns {boolean} True if valid, false if invalid (response already sent)\n */\nfunction validateSupabase(supabase, res) {\n  if (!supabase) {\n    sendErrorResponse(res, new Error('Database not configured'), 503, isProduction());\n    return false;\n  }\n  return true;\n}\n\n/**\n * Check if environment is production\n */\nfunction isProduction() {\n  return process.env.NODE_ENV === 'production';\n}\n\n/**\n * Structured logging with levels\n */\nfunction formatLog(level, message) {\n  const timestamp = new Date().toISOString();\n  return `[${timestamp}] [${level.toUpperCase()}] ${message}`;\n}\n\n/**\n * Info log (only in non-production)\n */\nfunction log(message, data = null) {\n  if (!isProduction()) {\n    if (data) {\n      console.log(formatLog('info', message), data);\n    } else {\n      console.log(formatLog('info', message));\n    }\n  }\n}\n\n/**\n * Error log (always logs, even in production)\n */\nfunction logError(message, error = null) {\n  if (error) {\n    console.error(formatLog('error', message), error);\n  } else {\n    console.error(formatLog('error', message));\n  }\n}\n\n/**\n * Warning log (only in non-production)\n */\nfunction logWarn(message, data = null) {\n  if (!isProduction()) {\n    if (data) {\n      console.warn(formatLog('warn', message), data);\n    } else {\n      console.warn(formatLog('warn', message));\n    }\n  }\n}\n\n/**\n * Debug log (only in non-production, for verbose debugging)\n */\nfunction logDebug(message, data = null) {\n  if (!isProduction() && process.env.DEBUG === 'true') {\n    if (data) {\n      console.log(formatLog('debug', message), data);\n    } else {\n      console.log(formatLog('debug', message));\n    }\n  }\n}\n\n/**\n * Simple in-memory rate limiter\n * For production, use Redis or similar distributed store\n */\nconst rateLimitStore = new Map();\n\nfunction checkRateLimit(ip, windowMs, maxRequests) {\n  const now = Date.now();\n  const key = ip;\n  \n  if (!rateLimitStore.has(key)) {\n    rateLimitStore.set(key, { count: 1, resetTime: now + windowMs });\n    return true;\n  }\n  \n  const record = rateLimitStore.get(key);\n  \n  // Reset if window expired\n  if (now > record.resetTime) {\n    record.count = 1;\n    record.resetTime = now + windowMs;\n    return true;\n  }\n  \n  // Check if limit exceeded\n  if (record.count >= maxRequests) {\n    return false;\n  }\n  \n  record.count++;\n  return true;\n}\n\n// Clean up old entries periodically\nconst { RATE_LIMIT } = require('./constants');\nsetInterval(() => {\n  const now = Date.now();\n  for (const [key, record] of rateLimitStore.entries()) {\n    if (now > record.resetTime) {\n      rateLimitStore.delete(key);\n    }\n  }\n}, RATE_LIMIT.WINDOW);\n\nmodule.exports = {\n  setCORSHeaders,\n  handlePreflight,\n  validateRequestSize,\n  sanitizeError,\n  sendErrorResponse,\n  sendSuccessResponse,\n  getClientIP,\n  validateSupabase,\n  checkRateLimit,\n  isProduction,\n  log,\n  logError,\n  logWarn,\n  logDebug,\n};\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 340, "column": 0}, "map": {"version":3,"sources":["file:///Users/ron.feathers/GitHub/LUCI/src/lib/next-api-helpers.js"],"sourcesContent":["/**\n * Next.js API Route Helper Functions\n * \n * Adapters for existing lib/api-helpers.js to work with Next.js\n * Can use require() for existing helpers\n */\n\nimport { NextResponse } from 'next/server';\n\n// Import existing helpers (they work in Next.js via require)\n// From src/lib/next-api-helpers.js -> up to src/ -> up to root/ -> lib/\nconst apiHelpers = require('../../lib/api-helpers');\nconst { MAX_REQUEST_SIZE, REQUEST_TIMEOUT, RATE_LIMIT } = require('../../lib/constants');\n\n/**\n * Set CORS headers for Next.js Response\n */\nexport function setCORSHeaders(response, methods = ['GET', 'POST', 'OPTIONS']) {\n  response.headers.set('Access-Control-Allow-Origin', '*');\n  response.headers.set('Access-Control-Allow-Methods', methods.join(', '));\n  response.headers.set('Access-Control-Allow-Headers', 'Content-Type, Authorization');\n  return response;\n}\n\n/**\n * Handle preflight OPTIONS requests for Next.js\n */\nexport async function handlePreflight(request) {\n  if (request.method === 'OPTIONS') {\n    const response = new NextResponse(null, { status: 200 });\n    return setCORSHeaders(response);\n  }\n  return null;\n}\n\n/**\n * Validate request size for Next.js\n */\nexport function validateRequestSize(request, maxSize = MAX_REQUEST_SIZE.DEFAULT) {\n  const contentLength = request.headers.get('content-length');\n  if (contentLength && parseInt(contentLength) > maxSize) {\n    return {\n      valid: false,\n      error: {\n        status: 413,\n        message: 'Request too large',\n      },\n    };\n  }\n  return { valid: true };\n}\n\n/**\n * Send error response for Next.js\n */\nexport function sendErrorResponse(error, statusCode = 500) {\n  const isProd = apiHelpers.isProduction();\n  const sanitized = {\n    error: isProd ? 'An error occurred' : (error?.message || 'An error occurred'),\n    message: isProd ? 'Please try again later or contact support if the problem persists.' : (error?.message || 'An error occurred'),\n  };\n  \n  if (!isProd && error?.stack) {\n    sanitized.stack = error.stack;\n  }\n  \n  const response = NextResponse.json(sanitized, { status: statusCode });\n  return setCORSHeaders(response);\n}\n\n/**\n * Send success response for Next.js\n */\nexport function sendSuccessResponse(data, statusCode = 200) {\n  const response = NextResponse.json(data, { status: statusCode });\n  return setCORSHeaders(response);\n}\n\n/**\n * Get client IP from Next.js Request\n */\nexport function getClientIP(request) {\n  const forwarded = request.headers.get('x-forwarded-for');\n  if (forwarded) {\n    return forwarded.split(',')[0].trim();\n  }\n  return request.headers.get('x-real-ip') || 'unknown';\n}\n\n/**\n * Validate Supabase client for Next.js\n */\nexport function validateSupabase(supabase) {\n  if (!supabase) {\n    return {\n      valid: false,\n      error: { status: 503, message: 'Database not configured' }\n    };\n  }\n  return { valid: true };\n}\n\n/**\n * Check rate limit\n */\nexport function checkRateLimit(ip, windowMs, maxRequests) {\n  return apiHelpers.checkRateLimit(ip, windowMs, maxRequests);\n}\n\n// Re-export other helpers\nexport const log = apiHelpers.log;\nexport const logError = apiHelpers.logError;\nexport const logWarn = apiHelpers.logWarn;\nexport const logDebug = apiHelpers.logDebug;\nexport const isProduction = apiHelpers.isProduction;\n\n"],"names":[],"mappings":"AAAA;;;;;CAKC;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAED;;AAEA,6DAA6D;AAC7D,wEAAwE;AACxE,MAAM;AACN,MAAM,EAAE,gBAAgB,EAAE,eAAe,EAAE,UAAU,EAAE;AAKhD,SAAS,eAAe,QAAQ,EAAE,UAAU;IAAC;IAAO;IAAQ;CAAU;IAC3E,SAAS,OAAO,CAAC,GAAG,CAAC,+BAA+B;IACpD,SAAS,OAAO,CAAC,GAAG,CAAC,gCAAgC,QAAQ,IAAI,CAAC;IAClE,SAAS,OAAO,CAAC,GAAG,CAAC,gCAAgC;IACrD,OAAO;AACT;AAKO,eAAe,gBAAgB,OAAO;IAC3C,IAAI,QAAQ,MAAM,KAAK,WAAW;QAChC,MAAM,WAAW,IAAI,gJAAY,CAAC,MAAM;YAAE,QAAQ;QAAI;QACtD,OAAO,eAAe;IACxB;IACA,OAAO;AACT;AAKO,SAAS,oBAAoB,OAAO,EAAE,UAAU,iBAAiB,OAAO;IAC7E,MAAM,gBAAgB,QAAQ,OAAO,CAAC,GAAG,CAAC;IAC1C,IAAI,iBAAiB,SAAS,iBAAiB,SAAS;QACtD,OAAO;YACL,OAAO;YACP,OAAO;gBACL,QAAQ;gBACR,SAAS;YACX;QACF;IACF;IACA,OAAO;QAAE,OAAO;IAAK;AACvB;AAKO,SAAS,kBAAkB,KAAK,EAAE,aAAa,GAAG;IACvD,MAAM,SAAS,WAAW,YAAY;IACtC,MAAM,YAAY;QAChB,OAAO,SAAS,sBAAuB,OAAO,WAAW;QACzD,SAAS,SAAS,uEAAwE,OAAO,WAAW;IAC9G;IAEA,IAAI,CAAC,UAAU,OAAO,OAAO;QAC3B,UAAU,KAAK,GAAG,MAAM,KAAK;IAC/B;IAEA,MAAM,WAAW,gJAAY,CAAC,IAAI,CAAC,WAAW;QAAE,QAAQ;IAAW;IACnE,OAAO,eAAe;AACxB;AAKO,SAAS,oBAAoB,IAAI,EAAE,aAAa,GAAG;IACxD,MAAM,WAAW,gJAAY,CAAC,IAAI,CAAC,MAAM;QAAE,QAAQ;IAAW;IAC9D,OAAO,eAAe;AACxB;AAKO,SAAS,YAAY,OAAO;IACjC,MAAM,YAAY,QAAQ,OAAO,CAAC,GAAG,CAAC;IACtC,IAAI,WAAW;QACb,OAAO,UAAU,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI;IACrC;IACA,OAAO,QAAQ,OAAO,CAAC,GAAG,CAAC,gBAAgB;AAC7C;AAKO,SAAS,iBAAiB,QAAQ;IACvC,IAAI,CAAC,UAAU;QACb,OAAO;YACL,OAAO;YACP,OAAO;gBAAE,QAAQ;gBAAK,SAAS;YAA0B;QAC3D;IACF;IACA,OAAO;QAAE,OAAO;IAAK;AACvB;AAKO,SAAS,eAAe,EAAE,EAAE,QAAQ,EAAE,WAAW;IACtD,OAAO,WAAW,cAAc,CAAC,IAAI,UAAU;AACjD;AAGO,MAAM,MAAM,WAAW,GAAG;AAC1B,MAAM,WAAW,WAAW,QAAQ;AACpC,MAAM,UAAU,WAAW,OAAO;AAClC,MAAM,WAAW,WAAW,QAAQ;AACpC,MAAM,eAAe,WAAW,YAAY"}},
    {"offset": {"line": 465, "column": 0}, "map": {"version":3,"sources":["file:///Users/ron.feathers/GitHub/LUCI/lib/linkedin-url-utils.js"],"sourcesContent":["/**\n * LinkedIn URL Utility Functions\n * \n * Simple utilities for normalizing LinkedIn URLs from Salesforce contacts.\n * Note: We store LinkedIn URLs but do not use the LinkedIn API for enrichment.\n */\n\n/**\n * Normalize LinkedIn URL to full format\n * Handles incomplete URLs like \"in/username\" or \"/in/username\"\n * Returns full URL: https://www.linkedin.com/in/username\n */\nfunction normalizeLinkedInURL(url) {\n  if (!url || typeof url !== 'string') return null;\n  \n  // Trim whitespace\n  url = url.trim();\n  \n  // If already a full URL, return as is\n  if (url.startsWith('http://') || url.startsWith('https://')) {\n    return url;\n  }\n  \n  // If it's a URN, return as is\n  if (url.startsWith('urn:li:')) {\n    return url;\n  }\n  \n  // Handle incomplete URLs\n  // Remove leading slash if present\n  if (url.startsWith('/')) {\n    url = url.substring(1);\n  }\n  \n  // If it starts with \"in/\", add the domain\n  if (url.startsWith('in/')) {\n    return `https://www.linkedin.com/${url}`;\n  }\n  \n  // If it's just a username (no \"in/\" prefix), add it\n  if (!url.includes('/') && !url.includes('linkedin.com')) {\n    return `https://www.linkedin.com/in/${url}`;\n  }\n  \n  // If it contains linkedin.com but no protocol, add https://\n  if (url.includes('linkedin.com') && !url.startsWith('http')) {\n    return `https://${url}`;\n  }\n  \n  // Default: assume it's a profile path and add domain\n  if (url.startsWith('www.linkedin.com')) {\n    return `https://${url}`;\n  }\n  \n  // If we can't normalize it, return null\n  return null;\n}\n\nmodule.exports = {\n  normalizeLinkedInURL,\n};\n\n"],"names":[],"mappings":"AAAA;;;;;CAKC,GAED;;;;CAIC,GACD,SAAS,qBAAqB,GAAG;IAC/B,IAAI,CAAC,OAAO,OAAO,QAAQ,UAAU,OAAO;IAE5C,kBAAkB;IAClB,MAAM,IAAI,IAAI;IAEd,sCAAsC;IACtC,IAAI,IAAI,UAAU,CAAC,cAAc,IAAI,UAAU,CAAC,aAAa;QAC3D,OAAO;IACT;IAEA,8BAA8B;IAC9B,IAAI,IAAI,UAAU,CAAC,YAAY;QAC7B,OAAO;IACT;IAEA,yBAAyB;IACzB,kCAAkC;IAClC,IAAI,IAAI,UAAU,CAAC,MAAM;QACvB,MAAM,IAAI,SAAS,CAAC;IACtB;IAEA,0CAA0C;IAC1C,IAAI,IAAI,UAAU,CAAC,QAAQ;QACzB,OAAO,CAAC,yBAAyB,EAAE,KAAK;IAC1C;IAEA,oDAAoD;IACpD,IAAI,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,IAAI,QAAQ,CAAC,iBAAiB;QACvD,OAAO,CAAC,4BAA4B,EAAE,KAAK;IAC7C;IAEA,4DAA4D;IAC5D,IAAI,IAAI,QAAQ,CAAC,mBAAmB,CAAC,IAAI,UAAU,CAAC,SAAS;QAC3D,OAAO,CAAC,QAAQ,EAAE,KAAK;IACzB;IAEA,qDAAqD;IACrD,IAAI,IAAI,UAAU,CAAC,qBAAqB;QACtC,OAAO,CAAC,QAAQ,EAAE,KAAK;IACzB;IAEA,wCAAwC;IACxC,OAAO;AACT;AAEA,OAAO,OAAO,GAAG;IACf;AACF"}},
    {"offset": {"line": 516, "column": 0}, "map": {"version":3,"sources":["file:///Users/ron.feathers/GitHub/LUCI/lib/supabase-client.js"],"sourcesContent":["/**\n * Shared Supabase Client Utility\n * \n * Provides a consistent way to create Supabase clients across all API functions\n */\n\nfunction getSupabaseClient() {\n  try {\n    const { createClient } = require('@supabase/supabase-js');\n    const supabaseUrl = process.env.SUPABASE_URL;\n    const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n    \n    if (supabaseUrl && supabaseServiceKey) {\n      return createClient(supabaseUrl, supabaseServiceKey, {\n        auth: {\n          autoRefreshToken: false,\n          persistSession: false\n        }\n      });\n    }\n  } catch (error) {\n    // Only log in development\n    if (process.env.NODE_ENV !== 'production') {\n      console.warn('Supabase client not available:', error.message);\n    }\n  }\n  return null;\n}\n\nmodule.exports = { getSupabaseClient };\n\n"],"names":[],"mappings":"AAAA;;;;CAIC,GAED,SAAS;IACP,IAAI;QACF,MAAM,EAAE,YAAY,EAAE;QACtB,MAAM,cAAc,QAAQ,GAAG,CAAC,YAAY;QAC5C,MAAM,qBAAqB,QAAQ,GAAG,CAAC,yBAAyB;QAEhE,IAAI,eAAe,oBAAoB;YACrC,OAAO,aAAa,aAAa,oBAAoB;gBACnD,MAAM;oBACJ,kBAAkB;oBAClB,gBAAgB;gBAClB;YACF;QACF;IACF,EAAE,OAAO,OAAO;QACd,0BAA0B;QAC1B,wCAA2C;YACzC,QAAQ,IAAI,CAAC,kCAAkC,MAAM,OAAO;QAC9D;IACF;IACA,OAAO;AACT;AAEA,OAAO,OAAO,GAAG;IAAE;AAAkB"}},
    {"offset": {"line": 679, "column": 0}, "map": {"version":3,"sources":["file:///Users/ron.feathers/GitHub/LUCI/lib/salesforce-client.js"],"sourcesContent":["/**\n * Shared Salesforce Client Utilities\n * \n * Centralized Salesforce authentication and common operations\n */\n\nconst { getSupabaseClient } = require('./supabase-client');\nconst { log, logError, logWarn, isProduction } = require('./api-helpers');\n\n/**\n * Get jsforce client library\n */\nfunction getJsforceClient() {\n  try {\n    const jsforce = require('jsforce');\n    return jsforce;\n  } catch (error) {\n    logWarn('jsforce not available:', error.message);\n    return null;\n  }\n}\n\n/**\n * Authenticate with Salesforce using jsforce\n * \n * @param {Object} supabase - Supabase client instance\n * @returns {Promise<Object>} Connection object with connection, instanceUrl, and accessToken\n */\nasync function authenticateSalesforce(supabase) {\n  // Get Salesforce config from Supabase\n  const { data: config, error: configError } = await supabase\n    .from('salesforce_configs')\n    .select('*')\n    .eq('is_active', true)\n    .single();\n\n  if (configError) {\n    logError('Error fetching Salesforce config:', configError);\n    throw new Error(`Error fetching Salesforce config: ${configError.message}`);\n  }\n  \n  if (!config) {\n    logError('No active Salesforce configuration found in salesforce_configs table');\n    throw new Error('Salesforce configuration not found in Supabase. Please insert credentials into salesforce_configs table.');\n  }\n  \n  const jsforce = getJsforceClient();\n  if (!jsforce) {\n    logError('jsforce library not available');\n    throw new Error('jsforce library not available. Make sure jsforce is installed: npm install jsforce');\n  }\n\n  // Clean login URL (handle custom domains like leandata.my.salesforce.com)\n  let loginUrl = config.login_url || 'https://login.salesforce.com';\n  loginUrl = loginUrl.trim().replace(/\\/$/, '');\n  \n  // For custom domains ending in .my.salesforce.com, keep as-is\n  // jsforce will handle the authentication\n  if (!loginUrl.startsWith('http://') && !loginUrl.startsWith('https://')) {\n    loginUrl = 'https://' + loginUrl;\n  }\n\n  // Create connection\n  const conn = new jsforce.Connection({\n    loginUrl: loginUrl\n  });\n\n  // Authenticate (jsforce handles OAuth internally - no Client ID/Secret needed!)\n  try {\n    await conn.login(config.username, config.password + (config.security_token || ''));\n  } catch (error) {\n    // Try with password only if first attempt fails\n    if (error.message && error.message.includes('INVALID_LOGIN')) {\n      await conn.login(config.username, config.password);\n    } else {\n      throw error;\n    }\n  }\n\n  return {\n    connection: conn,\n    instanceUrl: conn.instanceUrl,\n    accessToken: conn.accessToken,\n  };\n}\n\n/**\n * Escape single quotes in SOQL queries to prevent injection\n * \n * @param {string} str - String to escape\n * @returns {string} Escaped string\n */\nfunction escapeSOQL(str) {\n  if (!str) return '';\n  return str.replace(/'/g, \"\\\\'\");\n}\n\nmodule.exports = {\n  getJsforceClient,\n  authenticateSalesforce,\n  escapeSOQL,\n};\n\n"],"names":[],"mappings":"AAAA;;;;CAIC,GAED,MAAM,EAAE,iBAAiB,EAAE;AAC3B,MAAM,EAAE,GAAG,EAAE,QAAQ,EAAE,OAAO,EAAE,YAAY,EAAE;AAE9C;;CAEC,GACD,SAAS;IACP,IAAI;QACF,MAAM;QACN,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,0BAA0B,MAAM,OAAO;QAC/C,OAAO;IACT;AACF;AAEA;;;;;CAKC,GACD,eAAe,uBAAuB,QAAQ;IAC5C,sCAAsC;IACtC,MAAM,EAAE,MAAM,MAAM,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,SAChD,IAAI,CAAC,sBACL,MAAM,CAAC,KACP,EAAE,CAAC,aAAa,MAChB,MAAM;IAET,IAAI,aAAa;QACf,SAAS,qCAAqC;QAC9C,MAAM,IAAI,MAAM,CAAC,kCAAkC,EAAE,YAAY,OAAO,EAAE;IAC5E;IAEA,IAAI,CAAC,QAAQ;QACX,SAAS;QACT,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,UAAU;IAChB,IAAI,CAAC,SAAS;QACZ,SAAS;QACT,MAAM,IAAI,MAAM;IAClB;IAEA,0EAA0E;IAC1E,IAAI,WAAW,OAAO,SAAS,IAAI;IACnC,WAAW,SAAS,IAAI,GAAG,OAAO,CAAC,OAAO;IAE1C,8DAA8D;IAC9D,yCAAyC;IACzC,IAAI,CAAC,SAAS,UAAU,CAAC,cAAc,CAAC,SAAS,UAAU,CAAC,aAAa;QACvE,WAAW,aAAa;IAC1B;IAEA,oBAAoB;IACpB,MAAM,OAAO,IAAI,QAAQ,UAAU,CAAC;QAClC,UAAU;IACZ;IAEA,gFAAgF;IAChF,IAAI;QACF,MAAM,KAAK,KAAK,CAAC,OAAO,QAAQ,EAAE,OAAO,QAAQ,GAAG,CAAC,OAAO,cAAc,IAAI,EAAE;IAClF,EAAE,OAAO,OAAO;QACd,gDAAgD;QAChD,IAAI,MAAM,OAAO,IAAI,MAAM,OAAO,CAAC,QAAQ,CAAC,kBAAkB;YAC5D,MAAM,KAAK,KAAK,CAAC,OAAO,QAAQ,EAAE,OAAO,QAAQ;QACnD,OAAO;YACL,MAAM;QACR;IACF;IAEA,OAAO;QACL,YAAY;QACZ,aAAa,KAAK,WAAW;QAC7B,aAAa,KAAK,WAAW;IAC/B;AACF;AAEA;;;;;CAKC,GACD,SAAS,WAAW,GAAG;IACrB,IAAI,CAAC,KAAK,OAAO;IACjB,OAAO,IAAI,OAAO,CAAC,MAAM;AAC3B;AAEA,OAAO,OAAO,GAAG;IACf;IACA;IACA;AACF"}},
    {"offset": {"line": 763, "column": 0}, "map": {"version":3,"sources":["file:///Users/ron.feathers/GitHub/LUCI/lib/cache-helpers.js"],"sourcesContent":["/**\n * Shared Cache Helper Functions\n * \n * Common utilities for cache management\n */\n\nconst { CACHE_TTL } = require('./constants');\n\n/**\n * Check if cached data is fresh based on TTL\n * \n * @param {string|Date} lastSyncedAt - Last sync timestamp\n * @param {number} ttlHours - Time to live in hours (or string key from CACHE_TTL)\n * @returns {boolean} True if cache is fresh\n */\nfunction isCacheFresh(lastSyncedAt, ttlHours) {\n  if (!lastSyncedAt) return false;\n  \n  // If ttlHours is a string, look it up in CACHE_TTL\n  const ttl = typeof ttlHours === 'string' ? (CACHE_TTL[ttlHours] || CACHE_TTL.ACCOUNTS) : ttlHours;\n  \n  const now = new Date();\n  const cacheExpiry = ttl * 60 * 60 * 1000;\n  const lastSynced = new Date(lastSyncedAt);\n  \n  if (isNaN(lastSynced.getTime())) return false;\n  \n  return (now - lastSynced) < cacheExpiry;\n}\n\n/**\n * Check if cache is fresh for a given resource type\n * \n * @param {string|Date} lastSyncedAt - Last sync timestamp\n * @param {string} resourceType - Type of resource (ACCOUNTS, CASES, CONTACTS, etc.)\n * @returns {boolean} True if cache is fresh\n */\nfunction isResourceCacheFresh(lastSyncedAt, resourceType) {\n  return isCacheFresh(lastSyncedAt, resourceType);\n}\n\n/**\n * Get cache TTL in milliseconds for a resource type\n * \n * @param {string} resourceType - Type of resource\n * @returns {number} TTL in milliseconds\n */\nfunction getCacheTTLMs(resourceType) {\n  const ttlHours = CACHE_TTL[resourceType] || CACHE_TTL.ACCOUNTS;\n  return ttlHours * 60 * 60 * 1000;\n}\n\n/**\n * Calculate cache age in milliseconds\n * \n * @param {string|Date} lastSyncedAt - Last sync timestamp\n * @returns {number} Age in milliseconds, or null if invalid\n */\nfunction getCacheAge(lastSyncedAt) {\n  if (!lastSyncedAt) return null;\n  \n  const now = new Date();\n  const lastSynced = new Date(lastSyncedAt);\n  \n  if (isNaN(lastSynced.getTime())) return null;\n  \n  return now - lastSynced;\n}\n\nmodule.exports = {\n  isCacheFresh,\n  isResourceCacheFresh,\n  getCacheTTLMs,\n  getCacheAge,\n  CACHE_TTL,\n};\n\n"],"names":[],"mappings":"AAAA;;;;CAIC,GAED,MAAM,EAAE,SAAS,EAAE;AAEnB;;;;;;CAMC,GACD,SAAS,aAAa,YAAY,EAAE,QAAQ;IAC1C,IAAI,CAAC,cAAc,OAAO;IAE1B,mDAAmD;IACnD,MAAM,MAAM,OAAO,aAAa,WAAY,SAAS,CAAC,SAAS,IAAI,UAAU,QAAQ,GAAI;IAEzF,MAAM,MAAM,IAAI;IAChB,MAAM,cAAc,MAAM,KAAK,KAAK;IACpC,MAAM,aAAa,IAAI,KAAK;IAE5B,IAAI,MAAM,WAAW,OAAO,KAAK,OAAO;IAExC,OAAO,AAAC,MAAM,aAAc;AAC9B;AAEA;;;;;;CAMC,GACD,SAAS,qBAAqB,YAAY,EAAE,YAAY;IACtD,OAAO,aAAa,cAAc;AACpC;AAEA;;;;;CAKC,GACD,SAAS,cAAc,YAAY;IACjC,MAAM,WAAW,SAAS,CAAC,aAAa,IAAI,UAAU,QAAQ;IAC9D,OAAO,WAAW,KAAK,KAAK;AAC9B;AAEA;;;;;CAKC,GACD,SAAS,YAAY,YAAY;IAC/B,IAAI,CAAC,cAAc,OAAO;IAE1B,MAAM,MAAM,IAAI;IAChB,MAAM,aAAa,IAAI,KAAK;IAE5B,IAAI,MAAM,WAAW,OAAO,KAAK,OAAO;IAExC,OAAO,MAAM;AACf;AAEA,OAAO,OAAO,GAAG;IACf;IACA;IACA;IACA;IACA;AACF"}},
    {"offset": {"line": 825, "column": 0}, "map": {"version":3,"sources":["file:///Users/ron.feathers/GitHub/LUCI/src/app/api/salesforce-contacts/route.js"],"sourcesContent":["/**\n * Next.js App Router API Route for Salesforce Contacts\n * \n * Fetches Contacts from Salesforce for a specific account with intelligent caching\n * Only calls Salesforce API when cache is stale or missing\n * Filters out contacts with Contact Status = \"Unqualified\"\n */\n\nimport { NextRequest } from 'next/server';\nimport { getSupabaseClient } from '../../../lib/supabase-server';\nimport { handlePreflight, validateRequestSize, sendErrorResponse, sendSuccessResponse, validateSupabase, log, logError, logWarn, isProduction } from '../../../lib/next-api-helpers';\n\n// Can use require for lib files in Next.js API routes\nconst { normalizeLinkedInURL } = require('../../../../lib/linkedin-url-utils');\nconst { authenticateSalesforce, escapeSOQL } = require('../../../../lib/salesforce-client');\nconst { isCacheFresh } = require('../../../../lib/cache-helpers');\nconst { MAX_REQUEST_SIZE, CACHE_TTL, API_LIMITS } = require('../../../../lib/constants');\n\n/**\n * Query Salesforce for Contacts\n */\nasync function querySalesforceContacts(conn, salesforceAccountId) {\n  const escapedAccountId = salesforceAccountId.replace(/'/g, \"\\\\'\");\n  \n  const query = `SELECT Id, FirstName, LastName, Name, Email, Title, Phone, MobilePhone, \n                Contact_Status__c, AccountId, Account.Name,\n                Person_LinkedIn__c,\n                Department, ReportsToId, ReportsTo.Name, OwnerId, Owner.Name,\n                DoNotCall, HasOptedOutOfEmail,\n                MailingStreet, MailingCity, MailingState, MailingPostalCode, MailingCountry,\n                LastActivityDate, CreatedDate, LastModifiedDate,\n                LeadSource,\n                Birthdate, AssistantName, AssistantPhone, Description,\n                Account.Industry, Account.AnnualRevenue, Account.NumberOfEmployees, \n                Account.Type, Account.OwnerId, Account.Owner.Name\n                FROM Contact \n                WHERE AccountId = '${escapedAccountId}' \n                AND (Contact_Status__c != 'Unqualified' OR Contact_Status__c = null)\n                ORDER BY LastName, FirstName \n                LIMIT ${API_LIMITS.CONTACTS_PER_ACCOUNT}`;\n  \n  const result = await conn.query(query);\n  const contactCount = result.records?.length || 0;\n  \n  const filteredContacts = (result.records || []).filter(contact => {\n    const status = contact.Contact_Status__c || null;\n    return status !== 'Unqualified';\n  });\n  \n  if (filteredContacts.length > 0) {\n    log(`Retrieved ${filteredContacts.length} contacts from Salesforce`);\n  }\n  \n  if (filteredContacts.length === 0 && contactCount > 0) {\n    logWarn(`All ${contactCount} contacts for account ${salesforceAccountId} were filtered out (likely all have Contact_Status__c = 'Unqualified')`);\n  }\n  \n  return filteredContacts;\n}\n\n/**\n * Get cached contacts from Supabase\n */\nasync function getCachedContacts(supabase, salesforceAccountId) {\n  if (!supabase || !salesforceAccountId) return null;\n\n  const { data: contacts, error } = await supabase\n    .from('contacts')\n    .select('*')\n    .eq('salesforce_account_id', salesforceAccountId)\n    .order('last_name', { ascending: true })\n    .order('first_name', { ascending: true })\n    .limit(100);\n\n  if (error || !contacts || contacts.length === 0) {\n    return null;\n  }\n\n  const mostRecentSync = contacts.reduce((latest, current) => {\n    const currentDate = current.last_synced_at ? new Date(current.last_synced_at) : new Date(0);\n    const latestDate = latest ? new Date(latest) : new Date(0);\n    return currentDate > latestDate ? current.last_synced_at : latest;\n  }, null);\n\n  const isFresh = isCacheFresh(mostRecentSync, CACHE_TTL.CONTACTS);\n\n  return {\n    contacts,\n    isFresh,\n    lastSyncedAt: mostRecentSync,\n  };\n}\n\n/**\n * Sync contacts to Supabase cache\n */\nasync function syncContactsToSupabase(supabase, sfdcContacts, salesforceAccountId, accountId) {\n  if (!supabase || !sfdcContacts || sfdcContacts.length === 0) {\n    return [];\n  }\n\n  const syncedContacts = [];\n\n  for (const sfdcContact of sfdcContacts) {\n    const contactStatus = sfdcContact.Contact_Status__c || null;\n    if (contactStatus === 'Unqualified') {\n      continue;\n    }\n\n    const rawLinkedInURL = sfdcContact.Person_LinkedIn__c || null;\n    const linkedinURL = rawLinkedInURL ? normalizeLinkedInURL(rawLinkedInURL) : null;\n\n    const contactData = {\n      salesforce_id: sfdcContact.Id,\n      salesforce_account_id: salesforceAccountId,\n      account_id: accountId || null,\n      first_name: sfdcContact.FirstName || null,\n      last_name: sfdcContact.LastName || null,\n      name: sfdcContact.Name || null,\n      email: sfdcContact.Email || null,\n      title: sfdcContact.Title || null,\n      phone: sfdcContact.Phone || null,\n      mobile_phone: sfdcContact.MobilePhone || null,\n      contact_status: contactStatus,\n      account_name: sfdcContact.Account?.Name || null,\n      linkedin_url: linkedinURL,\n      department: sfdcContact.Department || null,\n      reports_to_id: sfdcContact.ReportsToId || null,\n      reports_to_name: sfdcContact.ReportsTo?.Name || null,\n      owner_id: sfdcContact.OwnerId || null,\n      owner_name: sfdcContact.Owner?.Name || null,\n      do_not_call: sfdcContact.DoNotCall || false,\n      email_opt_out: sfdcContact.HasOptedOutOfEmail || false,\n      mailing_street: sfdcContact.MailingStreet || null,\n      mailing_city: sfdcContact.MailingCity || null,\n      mailing_state: sfdcContact.MailingState || null,\n      mailing_postal_code: sfdcContact.MailingPostalCode || null,\n      mailing_country: sfdcContact.MailingCountry || null,\n      last_activity_date: sfdcContact.LastActivityDate ? new Date(sfdcContact.LastActivityDate).toISOString() : null,\n      created_date: sfdcContact.CreatedDate ? new Date(sfdcContact.CreatedDate).toISOString() : null,\n      last_modified_date: sfdcContact.LastModifiedDate ? new Date(sfdcContact.LastModifiedDate).toISOString() : null,\n      lead_source: sfdcContact.LeadSource || null,\n      birthdate: sfdcContact.Birthdate || null,\n      assistant_name: sfdcContact.AssistantName || null,\n      assistant_phone: sfdcContact.AssistantPhone || null,\n      description: sfdcContact.Description || null,\n      account_industry: sfdcContact.Account?.Industry || null,\n      account_annual_revenue: sfdcContact.Account?.AnnualRevenue || null,\n      account_number_of_employees: sfdcContact.Account?.NumberOfEmployees || null,\n      account_type: sfdcContact.Account?.Type || null,\n      account_owner_id: sfdcContact.Account?.OwnerId || null,\n      account_owner_name: sfdcContact.Account?.Owner?.Name || null,\n      last_synced_at: new Date().toISOString(),\n    };\n\n    let { data: contactRecord, error: contactError } = await supabase\n      .from('contacts')\n      .upsert(contactData, {\n        onConflict: 'salesforce_id',\n        ignoreDuplicates: false,\n      })\n      .select()\n      .single();\n\n    if (contactError && contactError.code === 'PGRST204') {\n      logWarn(`Missing column detected for contact ${sfdcContact.Id}, retrying with core fields only:`, contactError.message);\n      \n      const coreContactData = {\n        salesforce_id: sfdcContact.Id,\n        salesforce_account_id: salesforceAccountId,\n        account_id: accountId || null,\n        first_name: sfdcContact.FirstName || null,\n        last_name: sfdcContact.LastName || null,\n        name: sfdcContact.Name || null,\n        email: sfdcContact.Email || null,\n        title: sfdcContact.Title || null,\n        phone: sfdcContact.Phone || null,\n        mobile_phone: sfdcContact.MobilePhone || null,\n        contact_status: contactStatus,\n        account_name: sfdcContact.Account?.Name || null,\n        last_synced_at: new Date().toISOString(),\n      };\n\n      const retryResult = await supabase\n        .from('contacts')\n        .upsert(coreContactData, {\n          onConflict: 'salesforce_id',\n          ignoreDuplicates: false,\n        })\n        .select()\n        .single();\n\n      contactRecord = retryResult.data;\n      contactError = retryResult.error;\n    }\n\n    if (contactError) {\n      logError(`Error syncing contact ${sfdcContact.Id}:`, contactError);\n      continue;\n    }\n\n    syncedContacts.push(contactRecord);\n  }\n\n  return syncedContacts;\n}\n\n// Handle OPTIONS preflight\nexport async function OPTIONS() {\n  return handlePreflight(new NextRequest('http://localhost', { method: 'OPTIONS' }));\n}\n\n// GET /api/salesforce-contacts\nexport async function GET(request) {\n  const preflight = await handlePreflight(request);\n  if (preflight) return preflight;\n\n  const sizeValidation = validateRequestSize(request, MAX_REQUEST_SIZE.DEFAULT);\n  if (!sizeValidation.valid) {\n    return sendErrorResponse(new Error(sizeValidation.error.message), sizeValidation.error.status);\n  }\n\n  const { searchParams } = new URL(request.url);\n  const salesforceAccountId = searchParams.get('salesforceAccountId');\n  const accountId = searchParams.get('accountId');\n  const forceRefresh = searchParams.get('forceRefresh');\n\n  if (!salesforceAccountId) {\n    return sendErrorResponse(new Error('Missing required parameter: salesforceAccountId'), 400);\n  }\n\n  const shouldForceRefresh = forceRefresh === 'true' || forceRefresh === '1';\n\n  try {\n    const supabase = getSupabaseClient();\n    const validation = validateSupabase(supabase);\n    \n    if (!validation.valid) {\n      return sendErrorResponse(new Error(validation.error.message), validation.error.status);\n    }\n\n    // CACHE-FIRST: Check Supabase cache before querying Salesforce\n    if (!shouldForceRefresh) {\n      const cached = await getCachedContacts(supabase, salesforceAccountId);\n      \n      if (cached && cached.isFresh) {\n        log(`Returning ${cached.contacts.length} cached contacts`);\n        \n        return sendSuccessResponse({\n          contacts: cached.contacts.map(c => ({\n            id: c.salesforce_id,\n            firstName: c.first_name,\n            lastName: c.last_name,\n            name: c.name,\n            email: c.email,\n            title: c.title,\n            phone: c.phone,\n            mobilePhone: c.mobile_phone,\n            contactStatus: c.contact_status,\n            accountId: c.salesforce_account_id,\n            accountName: c.account_name,\n            linkedinURL: c.linkedin_url,\n          })),\n          total: cached.contacts.length,\n          cached: true,\n          lastSyncedAt: cached.lastSyncedAt,\n        });\n      }\n    }\n\n    // Cache is stale or missing - query Salesforce\n    try {\n      const sfdcAuth = await authenticateSalesforce(supabase);\n      const sfdcContacts = await querySalesforceContacts(sfdcAuth.connection, salesforceAccountId);\n\n      let accountUuid = null;\n      \n      if (accountId && accountId.includes('-') && accountId.length === 36) {\n        const { data: account, error: accountError } = await supabase\n          .from('accounts')\n          .select('id')\n          .eq('id', accountId)\n          .single();\n        \n        if (accountError) {\n          if (accountError.code !== 'PGRST116') {\n            logError('Error looking up account by UUID:', accountError);\n          }\n        } else if (account) {\n          accountUuid = account.id;\n        }\n      }\n      \n      if (!accountUuid) {\n        const { data: account, error: accountError } = await supabase\n          .from('accounts')\n          .select('id')\n          .eq('salesforce_id', salesforceAccountId)\n          .single();\n        \n        if (accountError) {\n          if (accountError.code !== 'PGRST116') {\n            logError('Error looking up account by salesforce_id:', accountError);\n          }\n        } else if (account) {\n          accountUuid = account.id;\n        }\n      }\n\n      const syncedContacts = await syncContactsToSupabase(supabase, sfdcContacts, salesforceAccountId, accountUuid);\n\n      const contacts = syncedContacts.map(c => ({\n        id: c.salesforce_id,\n        firstName: c.first_name,\n        lastName: c.last_name,\n        name: c.name,\n        email: c.email,\n        title: c.title,\n        phone: c.phone,\n        mobilePhone: c.mobile_phone,\n        contactStatus: c.contact_status,\n        accountId: c.salesforce_account_id,\n        accountName: c.account_name,\n        linkedinURL: c.linkedin_url,\n      }));\n\n      return sendSuccessResponse({\n        contacts: contacts,\n        total: contacts.length,\n        cached: false,\n        lastSyncedAt: new Date().toISOString(),\n      });\n    } catch (sfdcError) {\n      logError('Salesforce contacts query error:', sfdcError);\n      \n      // If Salesforce fails, try to return stale cache\n      const staleCache = await getCachedContacts(supabase, salesforceAccountId);\n      if (staleCache && staleCache.contacts.length > 0) {\n        log(`Salesforce query failed, using ${staleCache.contacts.length} stale cached contacts`);\n        \n        return sendSuccessResponse({\n          contacts: staleCache.contacts.map(c => ({\n            id: c.salesforce_id,\n            firstName: c.first_name,\n            lastName: c.last_name,\n            name: c.name,\n            email: c.email,\n            title: c.title,\n            phone: c.phone,\n            mobilePhone: c.mobile_phone,\n            contactStatus: c.contact_status,\n            accountId: c.salesforce_account_id,\n            accountName: c.account_name,\n            linkedinURL: c.linkedin_url,\n          })),\n          total: staleCache.contacts.length,\n          cached: true,\n          stale: true,\n          lastSyncedAt: staleCache.lastSyncedAt,\n        });\n      }\n      \n      logWarn('No cached contacts available and Salesforce query failed, returning empty array');\n      return sendSuccessResponse({\n        contacts: [],\n        total: 0,\n        cached: false,\n        error: isProduction() ? undefined : sfdcError.message,\n      });\n    }\n\n  } catch (error) {\n    logError('Error in salesforce-contacts function:', error);\n    logError('Error details:', error.message);\n    if (error.stack) {\n      logError('Error stack:', error.stack);\n    }\n    return sendErrorResponse(error, 500);\n  }\n}\n\n"],"names":[],"mappings":"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"}}]
}