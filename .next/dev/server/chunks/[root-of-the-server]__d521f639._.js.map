{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/ron.feathers/GitHub/LUCI/src/lib/supabase-server.js"],"sourcesContent":["/**\n * Server-side Supabase Client for Next.js\n * Uses the same logic as lib/supabase-client.js but as ES module\n */\n\nexport function getSupabaseClient() {\n  try {\n    const { createClient } = require('@supabase/supabase-js');\n    const supabaseUrl = process.env.SUPABASE_URL;\n    const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n    \n    if (!supabaseUrl || !supabaseServiceKey) {\n      const missing = [];\n      if (!supabaseUrl) missing.push('SUPABASE_URL');\n      if (!supabaseServiceKey) missing.push('SUPABASE_SERVICE_ROLE_KEY');\n      console.error(`[Supabase] Missing environment variables: ${missing.join(', ')}`);\n      return null;\n    }\n    \n    return createClient(supabaseUrl, supabaseServiceKey, {\n      auth: {\n        autoRefreshToken: false,\n        persistSession: false\n      }\n    });\n  } catch (error) {\n    console.error('[Supabase] Error creating client:', error.message);\n    if (error.stack) {\n      console.error('[Supabase] Stack:', error.stack);\n    }\n    return null;\n  }\n}\n\nexport function validateSupabase(supabase) {\n  if (!supabase) {\n    return {\n      valid: false,\n      error: { status: 503, message: 'Database not configured' }\n    };\n  }\n  return { valid: true };\n}\n\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;AAEM,SAAS;IACd,IAAI;QACF,MAAM,EAAE,YAAY,EAAE;QACtB,MAAM,cAAc,QAAQ,GAAG,CAAC,YAAY;QAC5C,MAAM,qBAAqB,QAAQ,GAAG,CAAC,yBAAyB;QAEhE,IAAI,CAAC,eAAe,CAAC,oBAAoB;YACvC,MAAM,UAAU,EAAE;YAClB,IAAI,CAAC,aAAa,QAAQ,IAAI,CAAC;YAC/B,IAAI,CAAC,oBAAoB,QAAQ,IAAI,CAAC;YACtC,QAAQ,KAAK,CAAC,CAAC,0CAA0C,EAAE,QAAQ,IAAI,CAAC,OAAO;YAC/E,OAAO;QACT;QAEA,OAAO,aAAa,aAAa,oBAAoB;YACnD,MAAM;gBACJ,kBAAkB;gBAClB,gBAAgB;YAClB;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qCAAqC,MAAM,OAAO;QAChE,IAAI,MAAM,KAAK,EAAE;YACf,QAAQ,KAAK,CAAC,qBAAqB,MAAM,KAAK;QAChD;QACA,OAAO;IACT;AACF;AAEO,SAAS,iBAAiB,QAAQ;IACvC,IAAI,CAAC,UAAU;QACb,OAAO;YACL,OAAO;YACP,OAAO;gBAAE,QAAQ;gBAAK,SAAS;YAA0B;QAC3D;IACF;IACA,OAAO;QAAE,OAAO;IAAK;AACvB"}},
    {"offset": {"line": 98, "column": 0}, "map": {"version":3,"sources":["file:///Users/ron.feathers/GitHub/LUCI/lib/constants.js"],"sourcesContent":["/**\n * Shared Constants\n * \n * Centralized constants used across the application\n */\n\n// Request limits\nconst MAX_REQUEST_SIZE = {\n  DEFAULT: 1024 * 1024, // 1MB\n  LARGE: 10 * 1024 * 1024, // 10MB (for sentiment analysis)\n};\n\n// Timeouts\nconst REQUEST_TIMEOUT = 30000; // 30 seconds\n\n// Rate limiting\nconst RATE_LIMIT = {\n  WINDOW: 60 * 1000, // 1 minute\n  MAX_REQUESTS: 10, // 10 requests per minute per IP\n};\n\n// Cache TTL (in hours, except CALENDAR_EVENTS which is in minutes)\nconst CACHE_TTL = {\n  ACCOUNTS: 1, // 1 hour\n  CASES: 1, // 1 hour\n  CONTACTS: 24, // 24 hours\n  TRANSCRIPTIONS: 24, // 24 hours\n  LINKEDIN_PROFILES: 24, // 24 hours\n  CALENDAR_EVENTS: 15, // 15 minutes (calendar events change frequently)\n};\n\n// API Limits\nconst API_LIMITS = {\n  CASES_PER_ACCOUNT: 25,\n  CONTACTS_PER_ACCOUNT: 100,\n  ACCOUNTS_PER_USER: 1000,\n};\n\nmodule.exports = {\n  MAX_REQUEST_SIZE,\n  REQUEST_TIMEOUT,\n  RATE_LIMIT,\n  CACHE_TTL,\n  API_LIMITS,\n};\n\n"],"names":[],"mappings":"AAAA;;;;CAIC,GAED,iBAAiB;AACjB,MAAM,mBAAmB;IACvB,SAAS,OAAO;IAChB,OAAO,KAAK,OAAO;AACrB;AAEA,WAAW;AACX,MAAM,kBAAkB,OAAO,aAAa;AAE5C,gBAAgB;AAChB,MAAM,aAAa;IACjB,QAAQ,KAAK;IACb,cAAc;AAChB;AAEA,mEAAmE;AACnE,MAAM,YAAY;IAChB,UAAU;IACV,OAAO;IACP,UAAU;IACV,gBAAgB;IAChB,mBAAmB;IACnB,iBAAiB;AACnB;AAEA,aAAa;AACb,MAAM,aAAa;IACjB,mBAAmB;IACnB,sBAAsB;IACtB,mBAAmB;AACrB;AAEA,OAAO,OAAO,GAAG;IACf;IACA;IACA;IACA;IACA;AACF"}},
    {"offset": {"line": 139, "column": 0}, "map": {"version":3,"sources":["file:///Users/ron.feathers/GitHub/LUCI/lib/api-helpers.js"],"sourcesContent":["/**\n * Shared API Helper Functions\n * \n * Common utilities for Vercel serverless functions\n */\n\nconst { MAX_REQUEST_SIZE, REQUEST_TIMEOUT } = require('./constants');\n\n/**\n * Set standard CORS headers\n */\nfunction setCORSHeaders(res, methods = ['GET', 'POST', 'OPTIONS']) {\n  res.setHeader('Access-Control-Allow-Origin', '*');\n  res.setHeader('Access-Control-Allow-Methods', methods.join(', '));\n  res.setHeader('Access-Control-Allow-Headers', 'Content-Type, Authorization');\n}\n\n/**\n * Handle preflight OPTIONS requests\n */\nfunction handlePreflight(req, res) {\n  if (req.method === 'OPTIONS') {\n    setCORSHeaders(res);\n    return res.status(200).end();\n  }\n  return false;\n}\n\n/**\n * Validate request size\n */\nfunction validateRequestSize(req, maxSize = MAX_REQUEST_SIZE.DEFAULT) {\n  const contentLength = req.headers['content-length'];\n  if (contentLength && parseInt(contentLength) > maxSize) {\n    return {\n      valid: false,\n      error: {\n        status: 413,\n        message: 'Request too large',\n      },\n    };\n  }\n  return { valid: true };\n}\n\n/**\n * Sanitize error message for production\n */\nfunction sanitizeError(error, isProduction = false) {\n  if (isProduction) {\n    // In production, don't expose internal error details\n    return {\n      error: 'An error occurred',\n      message: 'Please try again later or contact support if the problem persists.',\n    };\n  }\n  \n  // In development, return full error details\n  return {\n    error: error.message || 'An error occurred',\n    message: error.message,\n    stack: error.stack,\n  };\n}\n\n/**\n * Standard error response\n */\nfunction sendErrorResponse(res, error, statusCode = 500, isProduction = false) {\n  setCORSHeaders(res);\n  const sanitized = sanitizeError(error, isProduction);\n  return res.status(statusCode).json(sanitized);\n}\n\n/**\n * Standard success response\n */\nfunction sendSuccessResponse(res, data, statusCode = 200) {\n  setCORSHeaders(res);\n  return res.status(statusCode).json(data);\n}\n\n/**\n * Get client IP address from request\n */\nfunction getClientIP(req) {\n  return req.headers['x-forwarded-for']?.split(',')[0] || \n         req.headers['x-real-ip'] || \n         req.connection?.remoteAddress || \n         'unknown';\n}\n\n/**\n * Validate Supabase client and return error response if invalid\n * \n * @param {Object|null} supabase - Supabase client instance\n * @param {Object} res - Express response object\n * @returns {boolean} True if valid, false if invalid (response already sent)\n */\nfunction validateSupabase(supabase, res) {\n  if (!supabase) {\n    sendErrorResponse(res, new Error('Database not configured'), 503, isProduction());\n    return false;\n  }\n  return true;\n}\n\n/**\n * Check if environment is production\n */\nfunction isProduction() {\n  return process.env.NODE_ENV === 'production';\n}\n\n/**\n * Structured logging with levels\n */\nfunction formatLog(level, message) {\n  const timestamp = new Date().toISOString();\n  return `[${timestamp}] [${level.toUpperCase()}] ${message}`;\n}\n\n/**\n * Info log (only in non-production)\n */\nfunction log(message, data = null) {\n  if (!isProduction()) {\n    if (data) {\n      console.log(formatLog('info', message), data);\n    } else {\n      console.log(formatLog('info', message));\n    }\n  }\n}\n\n/**\n * Error log (always logs, even in production)\n */\nfunction logError(message, error = null) {\n  if (error) {\n    console.error(formatLog('error', message), error);\n  } else {\n    console.error(formatLog('error', message));\n  }\n}\n\n/**\n * Warning log (only in non-production)\n */\nfunction logWarn(message, data = null) {\n  if (!isProduction()) {\n    if (data) {\n      console.warn(formatLog('warn', message), data);\n    } else {\n      console.warn(formatLog('warn', message));\n    }\n  }\n}\n\n/**\n * Debug log (only in non-production, for verbose debugging)\n */\nfunction logDebug(message, data = null) {\n  if (!isProduction() && process.env.DEBUG === 'true') {\n    if (data) {\n      console.log(formatLog('debug', message), data);\n    } else {\n      console.log(formatLog('debug', message));\n    }\n  }\n}\n\n/**\n * Simple in-memory rate limiter\n * For production, use Redis or similar distributed store\n */\nconst rateLimitStore = new Map();\n\nfunction checkRateLimit(ip, windowMs, maxRequests) {\n  const now = Date.now();\n  const key = ip;\n  \n  if (!rateLimitStore.has(key)) {\n    rateLimitStore.set(key, { count: 1, resetTime: now + windowMs });\n    return true;\n  }\n  \n  const record = rateLimitStore.get(key);\n  \n  // Reset if window expired\n  if (now > record.resetTime) {\n    record.count = 1;\n    record.resetTime = now + windowMs;\n    return true;\n  }\n  \n  // Check if limit exceeded\n  if (record.count >= maxRequests) {\n    return false;\n  }\n  \n  record.count++;\n  return true;\n}\n\n// Clean up old entries periodically\nconst { RATE_LIMIT } = require('./constants');\nsetInterval(() => {\n  const now = Date.now();\n  for (const [key, record] of rateLimitStore.entries()) {\n    if (now > record.resetTime) {\n      rateLimitStore.delete(key);\n    }\n  }\n}, RATE_LIMIT.WINDOW);\n\nmodule.exports = {\n  setCORSHeaders,\n  handlePreflight,\n  validateRequestSize,\n  sanitizeError,\n  sendErrorResponse,\n  sendSuccessResponse,\n  getClientIP,\n  validateSupabase,\n  checkRateLimit,\n  isProduction,\n  log,\n  logError,\n  logWarn,\n  logDebug,\n};\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 340, "column": 0}, "map": {"version":3,"sources":["file:///Users/ron.feathers/GitHub/LUCI/src/lib/next-api-helpers.js"],"sourcesContent":["/**\n * Next.js API Route Helper Functions\n * \n * Adapters for existing lib/api-helpers.js to work with Next.js\n * Can use require() for existing helpers\n */\n\nimport { NextResponse } from 'next/server';\n\n// Import existing helpers (they work in Next.js via require)\n// From src/lib/next-api-helpers.js -> up to src/ -> up to root/ -> lib/\nconst apiHelpers = require('../../lib/api-helpers');\nconst { MAX_REQUEST_SIZE, REQUEST_TIMEOUT, RATE_LIMIT } = require('../../lib/constants');\n\n/**\n * Set CORS headers for Next.js Response\n */\nexport function setCORSHeaders(response, methods = ['GET', 'POST', 'OPTIONS']) {\n  response.headers.set('Access-Control-Allow-Origin', '*');\n  response.headers.set('Access-Control-Allow-Methods', methods.join(', '));\n  response.headers.set('Access-Control-Allow-Headers', 'Content-Type, Authorization');\n  return response;\n}\n\n/**\n * Handle preflight OPTIONS requests for Next.js\n */\nexport async function handlePreflight(request) {\n  if (request.method === 'OPTIONS') {\n    const response = new NextResponse(null, { status: 200 });\n    return setCORSHeaders(response);\n  }\n  return null;\n}\n\n/**\n * Validate request size for Next.js\n */\nexport function validateRequestSize(request, maxSize = MAX_REQUEST_SIZE.DEFAULT) {\n  const contentLength = request.headers.get('content-length');\n  if (contentLength && parseInt(contentLength) > maxSize) {\n    return {\n      valid: false,\n      error: {\n        status: 413,\n        message: 'Request too large',\n      },\n    };\n  }\n  return { valid: true };\n}\n\n/**\n * Send error response for Next.js\n */\nexport function sendErrorResponse(error, statusCode = 500) {\n  const isProd = apiHelpers.isProduction();\n  const sanitized = {\n    error: isProd ? 'An error occurred' : (error?.message || 'An error occurred'),\n    message: isProd ? 'Please try again later or contact support if the problem persists.' : (error?.message || 'An error occurred'),\n  };\n  \n  if (!isProd && error?.stack) {\n    sanitized.stack = error.stack;\n  }\n  \n  const response = NextResponse.json(sanitized, { status: statusCode });\n  return setCORSHeaders(response);\n}\n\n/**\n * Send success response for Next.js\n */\nexport function sendSuccessResponse(data, statusCode = 200) {\n  const response = NextResponse.json(data, { status: statusCode });\n  return setCORSHeaders(response);\n}\n\n/**\n * Get client IP from Next.js Request\n */\nexport function getClientIP(request) {\n  const forwarded = request.headers.get('x-forwarded-for');\n  if (forwarded) {\n    return forwarded.split(',')[0].trim();\n  }\n  return request.headers.get('x-real-ip') || 'unknown';\n}\n\n/**\n * Validate Supabase client for Next.js\n */\nexport function validateSupabase(supabase) {\n  if (!supabase) {\n    return {\n      valid: false,\n      error: { status: 503, message: 'Database not configured' }\n    };\n  }\n  return { valid: true };\n}\n\n/**\n * Check rate limit\n */\nexport function checkRateLimit(ip, windowMs, maxRequests) {\n  return apiHelpers.checkRateLimit(ip, windowMs, maxRequests);\n}\n\n// Re-export other helpers\nexport const log = apiHelpers.log;\nexport const logError = apiHelpers.logError;\nexport const logWarn = apiHelpers.logWarn;\nexport const logDebug = apiHelpers.logDebug;\nexport const isProduction = apiHelpers.isProduction;\n\n"],"names":[],"mappings":"AAAA;;;;;CAKC;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAED;;AAEA,6DAA6D;AAC7D,wEAAwE;AACxE,MAAM;AACN,MAAM,EAAE,gBAAgB,EAAE,eAAe,EAAE,UAAU,EAAE;AAKhD,SAAS,eAAe,QAAQ,EAAE,UAAU;IAAC;IAAO;IAAQ;CAAU;IAC3E,SAAS,OAAO,CAAC,GAAG,CAAC,+BAA+B;IACpD,SAAS,OAAO,CAAC,GAAG,CAAC,gCAAgC,QAAQ,IAAI,CAAC;IAClE,SAAS,OAAO,CAAC,GAAG,CAAC,gCAAgC;IACrD,OAAO;AACT;AAKO,eAAe,gBAAgB,OAAO;IAC3C,IAAI,QAAQ,MAAM,KAAK,WAAW;QAChC,MAAM,WAAW,IAAI,gJAAY,CAAC,MAAM;YAAE,QAAQ;QAAI;QACtD,OAAO,eAAe;IACxB;IACA,OAAO;AACT;AAKO,SAAS,oBAAoB,OAAO,EAAE,UAAU,iBAAiB,OAAO;IAC7E,MAAM,gBAAgB,QAAQ,OAAO,CAAC,GAAG,CAAC;IAC1C,IAAI,iBAAiB,SAAS,iBAAiB,SAAS;QACtD,OAAO;YACL,OAAO;YACP,OAAO;gBACL,QAAQ;gBACR,SAAS;YACX;QACF;IACF;IACA,OAAO;QAAE,OAAO;IAAK;AACvB;AAKO,SAAS,kBAAkB,KAAK,EAAE,aAAa,GAAG;IACvD,MAAM,SAAS,WAAW,YAAY;IACtC,MAAM,YAAY;QAChB,OAAO,SAAS,sBAAuB,OAAO,WAAW;QACzD,SAAS,SAAS,uEAAwE,OAAO,WAAW;IAC9G;IAEA,IAAI,CAAC,UAAU,OAAO,OAAO;QAC3B,UAAU,KAAK,GAAG,MAAM,KAAK;IAC/B;IAEA,MAAM,WAAW,gJAAY,CAAC,IAAI,CAAC,WAAW;QAAE,QAAQ;IAAW;IACnE,OAAO,eAAe;AACxB;AAKO,SAAS,oBAAoB,IAAI,EAAE,aAAa,GAAG;IACxD,MAAM,WAAW,gJAAY,CAAC,IAAI,CAAC,MAAM;QAAE,QAAQ;IAAW;IAC9D,OAAO,eAAe;AACxB;AAKO,SAAS,YAAY,OAAO;IACjC,MAAM,YAAY,QAAQ,OAAO,CAAC,GAAG,CAAC;IACtC,IAAI,WAAW;QACb,OAAO,UAAU,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI;IACrC;IACA,OAAO,QAAQ,OAAO,CAAC,GAAG,CAAC,gBAAgB;AAC7C;AAKO,SAAS,iBAAiB,QAAQ;IACvC,IAAI,CAAC,UAAU;QACb,OAAO;YACL,OAAO;YACP,OAAO;gBAAE,QAAQ;gBAAK,SAAS;YAA0B;QAC3D;IACF;IACA,OAAO;QAAE,OAAO;IAAK;AACvB;AAKO,SAAS,eAAe,EAAE,EAAE,QAAQ,EAAE,WAAW;IACtD,OAAO,WAAW,cAAc,CAAC,IAAI,UAAU;AACjD;AAGO,MAAM,MAAM,WAAW,GAAG;AAC1B,MAAM,WAAW,WAAW,QAAQ;AACpC,MAAM,UAAU,WAAW,OAAO;AAClC,MAAM,WAAW,WAAW,QAAQ;AACpC,MAAM,eAAe,WAAW,YAAY"}},
    {"offset": {"line": 465, "column": 0}, "map": {"version":3,"sources":["file:///Users/ron.feathers/GitHub/LUCI/lib/supabase-client.js"],"sourcesContent":["/**\n * Shared Supabase Client Utility\n * \n * Provides a consistent way to create Supabase clients across all API functions\n */\n\nfunction getSupabaseClient() {\n  try {\n    const { createClient } = require('@supabase/supabase-js');\n    const supabaseUrl = process.env.SUPABASE_URL;\n    const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n    \n    if (supabaseUrl && supabaseServiceKey) {\n      return createClient(supabaseUrl, supabaseServiceKey, {\n        auth: {\n          autoRefreshToken: false,\n          persistSession: false\n        }\n      });\n    }\n  } catch (error) {\n    // Only log in development\n    if (process.env.NODE_ENV !== 'production') {\n      console.warn('Supabase client not available:', error.message);\n    }\n  }\n  return null;\n}\n\nmodule.exports = { getSupabaseClient };\n\n"],"names":[],"mappings":"AAAA;;;;CAIC,GAED,SAAS;IACP,IAAI;QACF,MAAM,EAAE,YAAY,EAAE;QACtB,MAAM,cAAc,QAAQ,GAAG,CAAC,YAAY;QAC5C,MAAM,qBAAqB,QAAQ,GAAG,CAAC,yBAAyB;QAEhE,IAAI,eAAe,oBAAoB;YACrC,OAAO,aAAa,aAAa,oBAAoB;gBACnD,MAAM;oBACJ,kBAAkB;oBAClB,gBAAgB;gBAClB;YACF;QACF;IACF,EAAE,OAAO,OAAO;QACd,0BAA0B;QAC1B,wCAA2C;YACzC,QAAQ,IAAI,CAAC,kCAAkC,MAAM,OAAO;QAC9D;IACF;IACA,OAAO;AACT;AAEA,OAAO,OAAO,GAAG;IAAE;AAAkB"}},
    {"offset": {"line": 628, "column": 0}, "map": {"version":3,"sources":["file:///Users/ron.feathers/GitHub/LUCI/lib/salesforce-client.js"],"sourcesContent":["/**\n * Shared Salesforce Client Utilities\n * \n * Centralized Salesforce authentication and common operations\n */\n\nconst { getSupabaseClient } = require('./supabase-client');\nconst { log, logError, logWarn, isProduction } = require('./api-helpers');\n\n/**\n * Get jsforce client library\n */\nfunction getJsforceClient() {\n  try {\n    const jsforce = require('jsforce');\n    return jsforce;\n  } catch (error) {\n    logWarn('jsforce not available:', error.message);\n    return null;\n  }\n}\n\n/**\n * Authenticate with Salesforce using jsforce\n * \n * @param {Object} supabase - Supabase client instance\n * @returns {Promise<Object>} Connection object with connection, instanceUrl, and accessToken\n */\nasync function authenticateSalesforce(supabase) {\n  // Get Salesforce config from Supabase\n  const { data: config, error: configError } = await supabase\n    .from('salesforce_configs')\n    .select('*')\n    .eq('is_active', true)\n    .single();\n\n  if (configError) {\n    logError('Error fetching Salesforce config:', configError);\n    throw new Error(`Error fetching Salesforce config: ${configError.message}`);\n  }\n  \n  if (!config) {\n    logError('No active Salesforce configuration found in salesforce_configs table');\n    throw new Error('Salesforce configuration not found in Supabase. Please insert credentials into salesforce_configs table.');\n  }\n  \n  const jsforce = getJsforceClient();\n  if (!jsforce) {\n    logError('jsforce library not available');\n    throw new Error('jsforce library not available. Make sure jsforce is installed: npm install jsforce');\n  }\n\n  // Clean login URL (handle custom domains like leandata.my.salesforce.com)\n  let loginUrl = config.login_url || 'https://login.salesforce.com';\n  loginUrl = loginUrl.trim().replace(/\\/$/, '');\n  \n  // For custom domains ending in .my.salesforce.com, keep as-is\n  // jsforce will handle the authentication\n  if (!loginUrl.startsWith('http://') && !loginUrl.startsWith('https://')) {\n    loginUrl = 'https://' + loginUrl;\n  }\n\n  // Create connection\n  const conn = new jsforce.Connection({\n    loginUrl: loginUrl\n  });\n\n  // Authenticate (jsforce handles OAuth internally - no Client ID/Secret needed!)\n  try {\n    await conn.login(config.username, config.password + (config.security_token || ''));\n  } catch (error) {\n    // Try with password only if first attempt fails\n    if (error.message && error.message.includes('INVALID_LOGIN')) {\n      await conn.login(config.username, config.password);\n    } else {\n      throw error;\n    }\n  }\n\n  return {\n    connection: conn,\n    instanceUrl: conn.instanceUrl,\n    accessToken: conn.accessToken,\n  };\n}\n\n/**\n * Escape single quotes in SOQL queries to prevent injection\n * \n * @param {string} str - String to escape\n * @returns {string} Escaped string\n */\nfunction escapeSOQL(str) {\n  if (!str) return '';\n  return str.replace(/'/g, \"\\\\'\");\n}\n\nmodule.exports = {\n  getJsforceClient,\n  authenticateSalesforce,\n  escapeSOQL,\n};\n\n"],"names":[],"mappings":"AAAA;;;;CAIC,GAED,MAAM,EAAE,iBAAiB,EAAE;AAC3B,MAAM,EAAE,GAAG,EAAE,QAAQ,EAAE,OAAO,EAAE,YAAY,EAAE;AAE9C;;CAEC,GACD,SAAS;IACP,IAAI;QACF,MAAM;QACN,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,0BAA0B,MAAM,OAAO;QAC/C,OAAO;IACT;AACF;AAEA;;;;;CAKC,GACD,eAAe,uBAAuB,QAAQ;IAC5C,sCAAsC;IACtC,MAAM,EAAE,MAAM,MAAM,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,SAChD,IAAI,CAAC,sBACL,MAAM,CAAC,KACP,EAAE,CAAC,aAAa,MAChB,MAAM;IAET,IAAI,aAAa;QACf,SAAS,qCAAqC;QAC9C,MAAM,IAAI,MAAM,CAAC,kCAAkC,EAAE,YAAY,OAAO,EAAE;IAC5E;IAEA,IAAI,CAAC,QAAQ;QACX,SAAS;QACT,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,UAAU;IAChB,IAAI,CAAC,SAAS;QACZ,SAAS;QACT,MAAM,IAAI,MAAM;IAClB;IAEA,0EAA0E;IAC1E,IAAI,WAAW,OAAO,SAAS,IAAI;IACnC,WAAW,SAAS,IAAI,GAAG,OAAO,CAAC,OAAO;IAE1C,8DAA8D;IAC9D,yCAAyC;IACzC,IAAI,CAAC,SAAS,UAAU,CAAC,cAAc,CAAC,SAAS,UAAU,CAAC,aAAa;QACvE,WAAW,aAAa;IAC1B;IAEA,oBAAoB;IACpB,MAAM,OAAO,IAAI,QAAQ,UAAU,CAAC;QAClC,UAAU;IACZ;IAEA,gFAAgF;IAChF,IAAI;QACF,MAAM,KAAK,KAAK,CAAC,OAAO,QAAQ,EAAE,OAAO,QAAQ,GAAG,CAAC,OAAO,cAAc,IAAI,EAAE;IAClF,EAAE,OAAO,OAAO;QACd,gDAAgD;QAChD,IAAI,MAAM,OAAO,IAAI,MAAM,OAAO,CAAC,QAAQ,CAAC,kBAAkB;YAC5D,MAAM,KAAK,KAAK,CAAC,OAAO,QAAQ,EAAE,OAAO,QAAQ;QACnD,OAAO;YACL,MAAM;QACR;IACF;IAEA,OAAO;QACL,YAAY;QACZ,aAAa,KAAK,WAAW;QAC7B,aAAa,KAAK,WAAW;IAC/B;AACF;AAEA;;;;;CAKC,GACD,SAAS,WAAW,GAAG;IACrB,IAAI,CAAC,KAAK,OAAO;IACjB,OAAO,IAAI,OAAO,CAAC,MAAM;AAC3B;AAEA,OAAO,OAAO,GAAG;IACf;IACA;IACA;AACF"}},
    {"offset": {"line": 712, "column": 0}, "map": {"version":3,"sources":["file:///Users/ron.feathers/GitHub/LUCI/lib/cache-helpers.js"],"sourcesContent":["/**\n * Shared Cache Helper Functions\n * \n * Common utilities for cache management\n */\n\nconst { CACHE_TTL } = require('./constants');\n\n/**\n * Check if cached data is fresh based on TTL\n * \n * @param {string|Date} lastSyncedAt - Last sync timestamp\n * @param {number} ttlHours - Time to live in hours (or string key from CACHE_TTL)\n * @returns {boolean} True if cache is fresh\n */\nfunction isCacheFresh(lastSyncedAt, ttlHours) {\n  if (!lastSyncedAt) return false;\n  \n  // If ttlHours is a string, look it up in CACHE_TTL\n  const ttl = typeof ttlHours === 'string' ? (CACHE_TTL[ttlHours] || CACHE_TTL.ACCOUNTS) : ttlHours;\n  \n  const now = new Date();\n  const cacheExpiry = ttl * 60 * 60 * 1000;\n  const lastSynced = new Date(lastSyncedAt);\n  \n  if (isNaN(lastSynced.getTime())) return false;\n  \n  return (now - lastSynced) < cacheExpiry;\n}\n\n/**\n * Check if cache is fresh for a given resource type\n * \n * @param {string|Date} lastSyncedAt - Last sync timestamp\n * @param {string} resourceType - Type of resource (ACCOUNTS, CASES, CONTACTS, etc.)\n * @returns {boolean} True if cache is fresh\n */\nfunction isResourceCacheFresh(lastSyncedAt, resourceType) {\n  return isCacheFresh(lastSyncedAt, resourceType);\n}\n\n/**\n * Get cache TTL in milliseconds for a resource type\n * \n * @param {string} resourceType - Type of resource\n * @returns {number} TTL in milliseconds\n */\nfunction getCacheTTLMs(resourceType) {\n  const ttlHours = CACHE_TTL[resourceType] || CACHE_TTL.ACCOUNTS;\n  return ttlHours * 60 * 60 * 1000;\n}\n\n/**\n * Calculate cache age in milliseconds\n * \n * @param {string|Date} lastSyncedAt - Last sync timestamp\n * @returns {number} Age in milliseconds, or null if invalid\n */\nfunction getCacheAge(lastSyncedAt) {\n  if (!lastSyncedAt) return null;\n  \n  const now = new Date();\n  const lastSynced = new Date(lastSyncedAt);\n  \n  if (isNaN(lastSynced.getTime())) return null;\n  \n  return now - lastSynced;\n}\n\nmodule.exports = {\n  isCacheFresh,\n  isResourceCacheFresh,\n  getCacheTTLMs,\n  getCacheAge,\n  CACHE_TTL,\n};\n\n"],"names":[],"mappings":"AAAA;;;;CAIC,GAED,MAAM,EAAE,SAAS,EAAE;AAEnB;;;;;;CAMC,GACD,SAAS,aAAa,YAAY,EAAE,QAAQ;IAC1C,IAAI,CAAC,cAAc,OAAO;IAE1B,mDAAmD;IACnD,MAAM,MAAM,OAAO,aAAa,WAAY,SAAS,CAAC,SAAS,IAAI,UAAU,QAAQ,GAAI;IAEzF,MAAM,MAAM,IAAI;IAChB,MAAM,cAAc,MAAM,KAAK,KAAK;IACpC,MAAM,aAAa,IAAI,KAAK;IAE5B,IAAI,MAAM,WAAW,OAAO,KAAK,OAAO;IAExC,OAAO,AAAC,MAAM,aAAc;AAC9B;AAEA;;;;;;CAMC,GACD,SAAS,qBAAqB,YAAY,EAAE,YAAY;IACtD,OAAO,aAAa,cAAc;AACpC;AAEA;;;;;CAKC,GACD,SAAS,cAAc,YAAY;IACjC,MAAM,WAAW,SAAS,CAAC,aAAa,IAAI,UAAU,QAAQ;IAC9D,OAAO,WAAW,KAAK,KAAK;AAC9B;AAEA;;;;;CAKC,GACD,SAAS,YAAY,YAAY;IAC/B,IAAI,CAAC,cAAc,OAAO;IAE1B,MAAM,MAAM,IAAI;IAChB,MAAM,aAAa,IAAI,KAAK;IAE5B,IAAI,MAAM,WAAW,OAAO,KAAK,OAAO;IAExC,OAAO,MAAM;AACf;AAEA,OAAO,OAAO,GAAG;IACf;IACA;IACA;IACA;IACA;AACF"}},
    {"offset": {"line": 774, "column": 0}, "map": {"version":3,"sources":["file:///Users/ron.feathers/GitHub/LUCI/src/app/api/salesforce-cases/route.js"],"sourcesContent":["/**\n * Next.js App Router API Route for Salesforce Cases/Tickets\n * \n * Fetches Cases from Salesforce for a specific account with intelligent caching\n * Only calls Salesforce API when cache is stale or missing\n */\n\nimport { NextRequest } from 'next/server';\nimport { getSupabaseClient } from '../../../lib/supabase-server';\nimport { handlePreflight, validateRequestSize, sendErrorResponse, sendSuccessResponse, validateSupabase, log, logError, isProduction } from '../../../lib/next-api-helpers';\n\n// Can use require for lib files in Next.js API routes\nconst { authenticateSalesforce, escapeSOQL } = require('../../../../lib/salesforce-client');\nconst { isCacheFresh } = require('../../../../lib/cache-helpers');\nconst { MAX_REQUEST_SIZE, CACHE_TTL, API_LIMITS } = require('../../../../lib/constants');\n\n/**\n * Get cached cases from Supabase\n */\nasync function getCachedCases(supabase, salesforceAccountId) {\n  if (!supabase || !salesforceAccountId) {\n    return null;\n  }\n  \n  const { data: cases, error } = await supabase\n    .from('cases')\n    .select('*')\n    .eq('salesforce_account_id', salesforceAccountId)\n    .order('created_date', { ascending: false })\n    .limit(API_LIMITS.CASES_PER_ACCOUNT);\n\n  if (error) {\n    logError('Error querying cached cases', error);\n    return null;\n  }\n\n  if (!cases || cases.length === 0) {\n    return null;\n  }\n\n  const mostRecentSync = cases.reduce((latest, current) => {\n    const currentDate = current.last_synced_at ? new Date(current.last_synced_at) : new Date(0);\n    const latestDate = latest ? new Date(latest) : new Date(0);\n    return currentDate > latestDate ? current.last_synced_at : latest;\n  }, null);\n\n  const isFresh = isCacheFresh(mostRecentSync, CACHE_TTL.CASES);\n\n  return {\n    cases: cases,\n    isFresh: isFresh,\n    lastSyncedAt: mostRecentSync,\n  };\n}\n\n/**\n * Query Salesforce for Cases\n */\nasync function querySalesforceCases(conn, salesforceAccountId) {\n  const escapedAccountId = escapeSOQL(salesforceAccountId);\n  \n  const caseQuery = `SELECT Id, CaseNumber, Subject, Status, Priority, Type, Reason, Origin, CreatedDate, ClosedDate, Description, \n                     ContactEmail, ContactId, Contact.Name\n                     FROM Case \n                     WHERE AccountId = '${escapedAccountId}' \n                     ORDER BY CreatedDate DESC \n                     LIMIT ${API_LIMITS.CASES_PER_ACCOUNT}`;\n  \n  try {\n    const result = await conn.query(caseQuery);\n    const caseCount = result.records?.length || 0;\n    \n    if (caseCount === 0) {\n      const simpleQuery = `SELECT Id, CaseNumber, Subject, Status, Priority, Type, Reason, Origin, CreatedDate, ClosedDate, Description, \n                           ContactEmail, ContactId\n                           FROM Case \n                           WHERE AccountId = '${escapedAccountId}' \n                           ORDER BY CreatedDate DESC \n                           LIMIT ${API_LIMITS.CASES_PER_ACCOUNT}`;\n      \n      try {\n        const simpleResult = await conn.query(simpleQuery);\n        const simpleCount = simpleResult.records?.length || 0;\n        if (simpleCount > 0) {\n          log(`⚠️ Simpler query returned ${simpleCount} cases - Contact.Name field may be causing issues`);\n          const contactIds = simpleResult.records\n            .filter(record => record.ContactId)\n            .map(record => record.ContactId);\n          \n          if (contactIds.length > 0) {\n            const contactPromises = contactIds.map(contactId =>\n              conn.sobject('Contact').retrieve(contactId, ['Name'])\n                .then(contact => ({ contactId, contact }))\n                .catch(error => ({ contactId, error }))\n            );\n            \n            const contactResults = await Promise.all(contactPromises);\n            const contactMap = new Map();\n            contactResults.forEach(({ contactId, contact, error }) => {\n              if (error) {\n                logError(`Could not fetch Contact.Name for ContactId ${contactId}`, error);\n                contactMap.set(contactId, null);\n              } else {\n                contactMap.set(contactId, { Name: contact.Name });\n              }\n            });\n            \n            simpleResult.records.forEach(record => {\n              if (record.ContactId) {\n                record.Contact = contactMap.get(record.ContactId) || null;\n              }\n            });\n          }\n          return simpleResult.records || [];\n        }\n      } catch (simpleError) {\n        logError('Simple query also failed:', simpleError);\n      }\n    }\n    \n    return result.records || [];\n  } catch (error) {\n    logError('Error querying Salesforce Cases:', error);\n    logError('Query that failed:', caseQuery);\n    logError('Account ID used:', salesforceAccountId);\n    \n    try {\n      log(`Attempting fallback query without Contact.Name for account ${salesforceAccountId}`);\n      const fallbackQuery = `SELECT Id, CaseNumber, Subject, Status, Priority, Type, Reason, Origin, CreatedDate, ClosedDate, Description, \n                              ContactEmail, ContactId\n                              FROM Case \n                              WHERE AccountId = '${escapedAccountId}' \n                              ORDER BY CreatedDate DESC \n                              LIMIT ${API_LIMITS.CASES_PER_ACCOUNT}`;\n      \n      const fallbackResult = await conn.query(fallbackQuery);\n      log(`Fallback query returned ${fallbackResult.records?.length || 0} cases`);\n      \n      if (fallbackResult.records && fallbackResult.records.length > 0) {\n        const contactIds = fallbackResult.records\n          .filter(record => record.ContactId)\n          .map(record => record.ContactId);\n        \n        if (contactIds.length > 0) {\n          const contactPromises = contactIds.map(contactId =>\n            conn.sobject('Contact').retrieve(contactId, ['Name'])\n              .then(contact => ({ contactId, contact }))\n              .catch(error => ({ contactId, error }))\n          );\n          \n          const contactResults = await Promise.all(contactPromises);\n          const contactMap = new Map();\n          contactResults.forEach(({ contactId, contact, error }) => {\n            if (error) {\n              logError(`Could not fetch Contact.Name for ContactId ${contactId}`, error);\n              contactMap.set(contactId, null);\n            } else {\n              contactMap.set(contactId, { Name: contact.Name });\n            }\n          });\n          \n          fallbackResult.records.forEach(record => {\n            if (record.ContactId) {\n              record.Contact = contactMap.get(record.ContactId) || null;\n            }\n          });\n        }\n      }\n      \n      return fallbackResult.records || [];\n    } catch (fallbackError) {\n      logError('Fallback query also failed:', fallbackError);\n      throw error;\n    }\n  }\n}\n\n/**\n * Sync cases to Supabase cache\n */\nasync function syncCasesToSupabase(supabase, sfdcCases, salesforceAccountId, accountId) {\n  if (!supabase || !sfdcCases || sfdcCases.length === 0) {\n    return [];\n  }\n\n  const syncedCases = [];\n\n  for (const sfdcCase of sfdcCases) {\n    const caseData = {\n      salesforce_id: sfdcCase.Id,\n      salesforce_account_id: salesforceAccountId,\n      account_id: accountId || null,\n      case_number: sfdcCase.CaseNumber || null,\n      subject: sfdcCase.Subject || null,\n      status: sfdcCase.Status || null,\n      priority: sfdcCase.Priority || null,\n      type: sfdcCase.Type || null,\n      reason: sfdcCase.Reason || null,\n      origin: sfdcCase.Origin || null,\n      created_date: sfdcCase.CreatedDate || null,\n      closed_date: sfdcCase.ClosedDate || null,\n      description: sfdcCase.Description || null,\n      last_synced_at: new Date().toISOString(),\n    };\n\n    if (sfdcCase.ContactEmail !== undefined) {\n      caseData.contact_email = sfdcCase.ContactEmail || null;\n    }\n    if (sfdcCase.ContactId !== undefined) {\n      caseData.contact_id = sfdcCase.ContactId || null;\n    }\n    if (sfdcCase.Contact?.Name !== undefined) {\n      caseData.contact_name = sfdcCase.Contact?.Name || null;\n    }\n\n    const { data: caseRecord, error: caseError } = await supabase\n      .from('cases')\n      .upsert(caseData, {\n        onConflict: 'salesforce_id',\n        ignoreDuplicates: false,\n      })\n      .select()\n      .single();\n\n    if (caseError) {\n      if (caseError.code === 'PGRST204' && (\n        caseError.message?.includes('contact_email') ||\n        caseError.message?.includes('contact_id') ||\n        caseError.message?.includes('contact_name')\n      )) {\n        logError(`Contact columns not found in cases table. Please run migration 013_add_case_contact_fields.sql. Retrying without contact fields for case ${sfdcCase.Id}`);\n        \n        delete caseData.contact_email;\n        delete caseData.contact_id;\n        delete caseData.contact_name;\n        \n        const { data: retryRecord, error: retryError } = await supabase\n          .from('cases')\n          .upsert(caseData, {\n            onConflict: 'salesforce_id',\n            ignoreDuplicates: false,\n          })\n          .select()\n          .single();\n        \n        if (retryError) {\n          logError(`Error syncing case ${sfdcCase.Id} (retry without contact fields):`, retryError);\n          continue;\n        }\n        \n        syncedCases.push(retryRecord);\n      } else {\n        logError(`Error syncing case ${sfdcCase.Id}:`, caseError);\n        continue;\n      }\n    } else {\n      syncedCases.push(caseRecord);\n    }\n  }\n\n  return syncedCases;\n}\n\n// Handle OPTIONS preflight\nexport async function OPTIONS() {\n  return handlePreflight(new NextRequest('http://localhost', { method: 'OPTIONS' }));\n}\n\n// GET /api/salesforce-cases\nexport async function GET(request) {\n  const preflight = await handlePreflight(request);\n  if (preflight) return preflight;\n\n  const sizeValidation = validateRequestSize(request, MAX_REQUEST_SIZE.DEFAULT);\n  if (!sizeValidation.valid) {\n    return sendErrorResponse(new Error(sizeValidation.error.message), sizeValidation.error.status);\n  }\n\n  const { searchParams } = new URL(request.url);\n  const salesforceAccountId = searchParams.get('salesforceAccountId');\n  const accountId = searchParams.get('accountId');\n  const forceRefresh = searchParams.get('forceRefresh');\n\n  if (!salesforceAccountId) {\n    return sendErrorResponse(new Error('Missing required parameter: salesforceAccountId'), 400);\n  }\n\n  const shouldForceRefresh = forceRefresh === 'true' || forceRefresh === '1';\n\n  try {\n    const supabase = getSupabaseClient();\n    const validation = validateSupabase(supabase);\n    \n    if (!validation.valid) {\n      return sendErrorResponse(new Error(validation.error.message), validation.error.status);\n    }\n\n    // CACHE-FIRST: Check Supabase cache before querying Salesforce\n    if (!shouldForceRefresh) {\n      const cached = await getCachedCases(supabase, salesforceAccountId);\n      \n      if (cached && cached.isFresh) {\n        const mappedCases = cached.cases.map(c => ({\n          id: c.salesforce_id,\n          caseNumber: c.case_number,\n          subject: c.subject,\n          status: c.status,\n          priority: c.priority,\n          type: c.type,\n          reason: c.reason,\n          origin: c.origin,\n          createdDate: c.created_date,\n          closedDate: c.closed_date,\n          description: c.description,\n          contactEmail: c.contact_email,\n          contactId: c.contact_id,\n          contactName: c.contact_name,\n        }));\n        \n        return sendSuccessResponse({\n          cases: mappedCases,\n          total: cached.cases.length,\n          cached: true,\n          lastSyncedAt: cached.lastSyncedAt,\n        });\n      } else if (cached && !cached.isFresh) {\n        log(`Cache stale for account ${salesforceAccountId}, refreshing from Salesforce`);\n      }\n    }\n\n    if (shouldForceRefresh) {\n      log(`Force refresh requested, querying Salesforce for account ${salesforceAccountId}`);\n    }\n\n    const sfdcAuth = await authenticateSalesforce(supabase);\n    const sfdcCases = await querySalesforceCases(sfdcAuth.connection, salesforceAccountId);\n    \n    if (sfdcCases.length > 0) {\n      log(`Retrieved ${sfdcCases.length} cases from Salesforce`);\n    }\n\n    let accountUuid = null;\n    \n    const isLikelyUUID = accountId && accountId.includes('-') && accountId.length === 36;\n    \n    if (isLikelyUUID) {\n      const [uuidResult, salesforceIdResult] = await Promise.all([\n        supabase.from('accounts').select('id').eq('id', accountId).single(),\n        supabase.from('accounts').select('id').eq('salesforce_id', salesforceAccountId).single()\n      ]);\n      \n      accountUuid = uuidResult.data?.id || salesforceIdResult.data?.id || null;\n    } else {\n      const { data: account } = await supabase\n        .from('accounts')\n        .select('id')\n        .eq('salesforce_id', salesforceAccountId)\n        .single();\n      accountUuid = account?.id || null;\n    }\n\n    const syncedCases = await syncCasesToSupabase(supabase, sfdcCases, salesforceAccountId, accountUuid);\n\n    const cases = syncedCases.map(c => ({\n      id: c.salesforce_id,\n      caseNumber: c.case_number,\n      subject: c.subject,\n      status: c.status,\n      priority: c.priority,\n      type: c.type,\n      reason: c.reason,\n      origin: c.origin,\n      createdDate: c.created_date,\n      closedDate: c.closed_date,\n      description: c.description,\n      contactEmail: c.contact_email,\n      contactId: c.contact_id,\n      contactName: c.contact_name,\n    }));\n    \n    return sendSuccessResponse({\n      cases: cases,\n      total: cases.length,\n      cached: false,\n      lastSyncedAt: new Date().toISOString(),\n      _debug: !isProduction() ? {\n        cacheLookup: false,\n        casesCount: cases.length,\n        salesforceAccountId: salesforceAccountId,\n      } : undefined,\n    });\n\n  } catch (error) {\n    logError('Error in salesforce-cases function:', error);\n    \n    // If Salesforce fails, try to return stale cache\n    const supabase = getSupabaseClient();\n    if (!shouldForceRefresh && supabase) {\n      const validation = validateSupabase(supabase);\n      if (validation.valid) {\n        const staleCache = await getCachedCases(supabase, salesforceAccountId);\n        if (staleCache && staleCache.cases.length > 0) {\n          log(`Salesforce query failed, using ${staleCache.cases.length} stale cached cases`);\n          \n          return sendSuccessResponse({\n            cases: staleCache.cases.map(c => ({\n              id: c.salesforce_id,\n              caseNumber: c.case_number,\n              subject: c.subject,\n              status: c.status,\n              priority: c.priority,\n              type: c.type,\n              reason: c.reason,\n              origin: c.origin,\n              createdDate: c.created_date,\n              closedDate: c.closed_date,\n              description: c.description,\n              contactEmail: c.contact_email,\n              contactId: c.contact_id,\n              contactName: c.contact_name,\n            })),\n            total: staleCache.cases.length,\n            cached: true,\n            stale: true,\n            lastSyncedAt: staleCache.lastSyncedAt,\n          });\n        }\n      }\n    }\n    \n    return sendErrorResponse(error, 500);\n  }\n}\n\n"],"names":[],"mappings":"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"}}]
}